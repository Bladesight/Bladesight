
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This chapter explains how we can use the SDoF fit method to infer the vibration parameters of a blade.">
      
      
      
      
        <link rel="prev" href="../ch7/">
      
      
        <link rel="next" href="../ch9/">
      
      
      <link rel="icon" href="../../../images/fab.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>8. Single Degree of Freedom (SDoF) Method - Bladesight Learning Centre</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M576%2048c0-11.1-5.7-21.4-15.2-27.2s-21.2-6.4-31.1-1.4L413.5%2077.5%20234.1%2017.6c-8.1-2.7-16.8-2.1-24.4%201.7l-128%2064C70.8%2088.8%2064%2099.9%2064%20112v352c0%2011.1%205.7%2021.4%2015.2%2027.2s21.2%206.4%2031.1%201.4l116.1-58.1%20173.3%2057.8c-4.3-6.4-8.5-13.1-12.6-19.9-11-18.3-21.9-39.3-30-61.8l-101.2-33.7V92.4l128%2042.7v99.3c31-35.8%2077-58.4%20128-58.4%2022.6%200%2044.2%204.4%2064%2012.5zM392%20341.9c0%2068.9%2064.1%20150.4%2098.6%20189.3%2011.6%2013%2031.3%2013%2042.9%200%2034.5-38.9%2098.6-120.4%2098.6-189.3%200-65.1-53.7-117.9-120-117.9S392%20276.8%20392%20341.9%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Literata:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Literata";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-6B961HRVZP"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-6B961HRVZP",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-6B961HRVZP",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    

<meta name="keywords" content="Blade Tip Timing, BTT, Non Intrusive Stress Measurement, NSMS, Turbine blade,Mechanical Vibration">


<meta property="og:title" content="Intro to BTT Ch8 - The SDoF fit method" />
<meta property="og:description" content="This chapter explains how we can use the SDoF fit method to infer the vibration parameters of a blade." />
<meta property="og:image" content="https://intro-to-btt-using-python-assets.s3.amazonaws.com/social_card_source_ch8.gif" />
<meta property="og:url" content="https://docs.bladesight.com/intro-to-bttch8/" />
<meta property="og:image:height" content="1362" />
<meta property="og:image:width" content="1970" />


<meta name="twitter:site" content="@bladesight" />
<meta name="twitter:creator" content="@dawiediamond" />

<meta name="twitter:title" content="Intro to BTT Ch8 - The SDoF fit method"/>
<meta name="twitter:image" content="https://intro-to-btt-using-python-assets.s3.amazonaws.com/social_card_source_ch8.gif"/>
<meta name="twitter:url" content="https://docs.bladesight.com/intro-to-bttch8/"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="This chapter explains how we can use the SDoF fit method to infer the vibration parameters of a blade."/>


<meta name="robots" content="index, follow, Blade Tip Timing, BTT, Non Intrusive Stress Measurement, NSMS, Time of Arrival, Turbine blade,Mechanical Vibration" />
  


  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="bladesight" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#single-degree-of-freedom-sdof-fit-method" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Bladesight Learning Centre" class="md-header__button md-logo" aria-label="Bladesight Learning Centre" data-md-component="logo">
      
  <img src="../../../assets/horizontal_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bladesight Learning Centre
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              8. Single Degree of Freedom (SDoF) Method
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="bladesight" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Bladesight Learning Centre

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ch1/" class="md-tabs__link">
          
  
  
  Introduction to Blade Tip Timing

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../datasets/diamond_et_al_2024_vary_ramp_rates_45" class="md-tabs__link">
          
  
  
  Datasets

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../reference/dataset_handler/" class="md-tabs__link">
          
  
  
  User Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!-- Determine classes -->


  



<!-- Navigation -->
<nav
  class="md-nav md-nav--primary md-nav--lifted"
  aria-label="Navigation"
  data-md-level="0"
>

  <!-- Site title -->
  <label class="md-nav__title" for="__drawer">
    <a
      href="../../.."
      title="Bladesight Learning Centre"
      class="md-nav__button md-logo"
      aria-label="Bladesight Learning Centre"
      data-md-component="logo"
    >
      
  <img src="../../../assets/horizontal_white.png" alt="logo">

    </a>
    Bladesight Learning Centre
  </label>

  <!-- Repository information -->
  

  <!-- Navigation list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bladesight Learning Centre
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Introduction to Blade Tip Timing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction to Blade Tip Timing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Blade Tip Timing's fundamental principle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Time of Arrival (ToA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Angle of Arrival (AoA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Allocating AoAs to blades
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Working with multiple probes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. Data Zeroing and Filtering
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. Synchronous Vibration and Sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    8. Single Degree of Freedom (SDoF) Method
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    8. Single Degree of Freedom (SDoF) Method
    
  </span>
  

      </a>
      
        
  
  <nav class="md-nav md-nav--secondary" aria-label="Table of contents">
    
    
    
      
    
    
<div id="mc_embed_shell">
    <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
<style type="text/css">
      #mc_embed_signup{background:#fff; false;clear:left; font:14px Helvetica,Arial,sans-serif; width: 200px;}
      /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
         We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<!-- <div id="mc_embed_signup">
  <form action="https://bladesight.us8.list-manage.com/subscribe/post?u=d61691d2e27bf9fdb772ac2d6&amp;id=5c2250604e&amp;f_id=006109e0f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" style="margin:0px 0px 0px 1rem;">
      <div id="mc_embed_signup_scroll"><h4>Subscribe to Bladesight's newsletterüëá</h4>
          <div class="mc-field-group"><label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label><input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required="" value=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span></div>
      <div id="mce-responses" class="clear foot">
          <div class="response" id="mce-error-response" style="display: none;"></div>
          <div class="response" id="mce-success-response" style="display: none;"></div>
      </div>
  <div aria-hidden="true" style="position: absolute; left: -5000px;">
      /* real people should not fill this in and expect good things - do not remove this or risk form bot signups */
      <input type="text" name="b_d61691d2e27bf9fdb772ac2d6_5c2250604e" tabindex="-1" value="">
  </div>
      <div class="optionalParent">
          <div class="clear foot">
              <input type="submit" name="subscribe" id="mc-embedded-subscribe" class="button" value="Subscribe">
          </div>
      </div>
  </div>
</form>
</div> -->

<script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';fnames[5]='BIRTHDAY';ftypes[5]='birthday';}(jQuery));var $mcj = jQuery.noConflict(true);</script></div>

      <label class="md-nav__title" for="__toc">
        <span class="md-nav__icon md-icon"></span>
        Table of contents
      </label>
      <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
        
          <li class="md-nav__item">
  <a href="#follow-along" class="md-nav__link">
    <span class="md-ellipsis">
      Follow along
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-the-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Getting the dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-nontrivial-nature-of-the-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The nontrivial nature of the problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resonance-window-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Resonance window selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-simple-objective-function" class="md-nav__link">
    <span class="md-ellipsis">
      A simple objective function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimization-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Optimization bounds
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optimization bounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bounds-for-the-natural-frequency" class="md-nav__link">
    <span class="md-ellipsis">
      Bounds for the natural frequency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounds-for-damping" class="md-nav__link">
    <span class="md-ellipsis">
      Bounds for damping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounds-for-the-static-deflection" class="md-nav__link">
    <span class="md-ellipsis">
      Bounds for the static deflection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solving-the-simple-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Solving the simple problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#amplitude-and-phase-offsets" class="md-nav__link">
    <span class="md-ellipsis">
      Amplitude and phase offsets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solving-the-improved-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Solving the improved problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-probe-solution" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple probe solution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimating-the-eo" class="md-nav__link">
    <span class="md-ellipsis">
      Estimating the EO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    <span class="md-ellipsis">
      Acknowledgements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coding-exercises" class="md-nav__link">
    <span class="md-ellipsis">
      Coding exercises
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Coding exercises">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-getting-the-amplitude-larger" class="md-nav__link">
    <span class="md-ellipsis">
      1. Getting the amplitude larger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-writing-a-function-we-can-use" class="md-nav__link">
    <span class="md-ellipsis">
      2. Writing a function we can use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-comparing-resonances-on-the-upward-and-downward-ramps" class="md-nav__link">
    <span class="md-ellipsis">
      3. Comparing resonances on the upward and downward ramps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    
  </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. Circumferential Fourier Fit (CFF) Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../afterword/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Afterword
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Datasets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets/diamond_et_al_2024_vary_ramp_rates_45" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Varying ramp rates with 45 degree pipe
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            User Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/dataset_handler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset handler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    btt
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            btt
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/btt/triggering_criteria/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Triggering criteria
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
  <br/>
  <br/>
  <br/>
  <a
    href="https://www.bladesight.com/"
    target="_blank"
    style="text-align: -webkit-center;"
  >
    <img src="https://intro-to-btt-using-python-assets.s3.amazonaws.com/kraken1.jpeg" 
    alt="Kraken" 
    style="width: 120px; display: flex; padding: 2px 0px; justify-content: center; align-items: center; border: 2px;">
    <p><strong>Unleash the Krakenüêô</strong></p>
    </a>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
  
  <nav class="md-nav md-nav--secondary" aria-label="Table of contents">
    
    
    
      
    
    
<div id="mc_embed_shell">
    <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
<style type="text/css">
      #mc_embed_signup{background:#fff; false;clear:left; font:14px Helvetica,Arial,sans-serif; width: 200px;}
      /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
         We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<!-- <div id="mc_embed_signup">
  <form action="https://bladesight.us8.list-manage.com/subscribe/post?u=d61691d2e27bf9fdb772ac2d6&amp;id=5c2250604e&amp;f_id=006109e0f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" style="margin:0px 0px 0px 1rem;">
      <div id="mc_embed_signup_scroll"><h4>Subscribe to Bladesight's newsletterüëá</h4>
          <div class="mc-field-group"><label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label><input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required="" value=""><span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span></div>
      <div id="mce-responses" class="clear foot">
          <div class="response" id="mce-error-response" style="display: none;"></div>
          <div class="response" id="mce-success-response" style="display: none;"></div>
      </div>
  <div aria-hidden="true" style="position: absolute; left: -5000px;">
      /* real people should not fill this in and expect good things - do not remove this or risk form bot signups */
      <input type="text" name="b_d61691d2e27bf9fdb772ac2d6_5c2250604e" tabindex="-1" value="">
  </div>
      <div class="optionalParent">
          <div class="clear foot">
              <input type="submit" name="subscribe" id="mc-embedded-subscribe" class="button" value="Subscribe">
          </div>
      </div>
  </div>
</form>
</div> -->

<script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';fnames[5]='BIRTHDAY';ftypes[5]='birthday';}(jQuery));var $mcj = jQuery.noConflict(true);</script></div>

      <label class="md-nav__title" for="__toc">
        <span class="md-nav__icon md-icon"></span>
        Table of contents
      </label>
      <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
        
          <li class="md-nav__item">
  <a href="#follow-along" class="md-nav__link">
    <span class="md-ellipsis">
      Follow along
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-the-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Getting the dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-nontrivial-nature-of-the-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The nontrivial nature of the problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resonance-window-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Resonance window selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-simple-objective-function" class="md-nav__link">
    <span class="md-ellipsis">
      A simple objective function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimization-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Optimization bounds
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optimization bounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bounds-for-the-natural-frequency" class="md-nav__link">
    <span class="md-ellipsis">
      Bounds for the natural frequency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounds-for-damping" class="md-nav__link">
    <span class="md-ellipsis">
      Bounds for damping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounds-for-the-static-deflection" class="md-nav__link">
    <span class="md-ellipsis">
      Bounds for the static deflection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solving-the-simple-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Solving the simple problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#amplitude-and-phase-offsets" class="md-nav__link">
    <span class="md-ellipsis">
      Amplitude and phase offsets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solving-the-improved-problem" class="md-nav__link">
    <span class="md-ellipsis">
      Solving the improved problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-probe-solution" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple probe solution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimating-the-eo" class="md-nav__link">
    <span class="md-ellipsis">
      Estimating the EO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    <span class="md-ellipsis">
      Acknowledgements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coding-exercises" class="md-nav__link">
    <span class="md-ellipsis">
      Coding exercises
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Coding exercises">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-getting-the-amplitude-larger" class="md-nav__link">
    <span class="md-ellipsis">
      1. Getting the amplitude larger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-writing-a-function-we-can-use" class="md-nav__link">
    <span class="md-ellipsis">
      2. Writing a function we can use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-comparing-resonances-on-the-upward-and-downward-ramps" class="md-nav__link">
    <span class="md-ellipsis">
      3. Comparing resonances on the upward and downward ramps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    
  </nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  


  <nav class="md-tags" hidden>
    
      
      
      
        <span class="md-tag">BTT</span>
      
    
      
      
      
        <span class="md-tag">Blade Tip Timing</span>
      
    
      
      
      
        <span class="md-tag">Mechanical Vibration</span>
      
    
      
      
      
        <span class="md-tag">NSMS</span>
      
    
      
      
      
        <span class="md-tag">Non Intrusive Stress Measurement</span>
      
    
      
      
      
        <span class="md-tag">Time of Arrival</span>
      
    
      
      
      
        <span class="md-tag">Turbine blade</span>
      
    
  </nav>



<details class="abstract">
<summary>You are here</summary>
<p><figure markdown>
<img alt="BTT Tutorial Roadmap" src="BTT_Tutorial_Outline_Ch7.svg" width="500" />
</figure></p>
</details>
<h1 id="single-degree-of-freedom-sdof-fit-method">Single Degree of Freedom (SDoF) Fit Method</h1>
<p>In the previous chapter, we used a fully defined SDoF vibration model to <em>generate</em> the samples we typically observe in BTT data. </p>
<p>In this chapter, we do the opposite. </p>
<p>The <em>SDoF fit method</em> comprises solving the <em>inverse problem</em>. In other words, we <em>already have</em>  the sampled tip deflections for each probe. Now we need to find the SDoF model's parameters. I've put together a GIF that captures the essence of the task. Our model (represented by the red line) changes until it lies on top of the observed datapoints (blue).</p>
<figure>
<p><img alt="SDoF Fit intro gif" src="intro_gif.gif" />
  </p>
<figcaption><a id='figure_01'><strong>Figure 1:</strong></a>
    An animation of how the SDoF fit method's predicted tip deflections change as the natural frequency, damping ratio, and static deflection converge to the correct solution. I added some animations to the dots and a glitch effect. These effects do not have any meaning... I just couldn't help myself üòÅ.
  </figcaption>
</figure>
<p>We restate the SDoF equations below for convenience.
<a name='eq_1'></a></p>
<div class="arithmatex">\[\begin{equation}
x(t) = X(\omega) \cos \left( \theta_s \cdot EO - \phi(\omega) \right)
\end{equation}\]</div>
<p><a name='eq_2'></a></p>
<div class="arithmatex">\[\begin{equation}
X(\omega) = \frac{\delta_{\text{st}}}{ \sqrt{ (1 - r^2)^2 + (2 \zeta r)^2 } }\\
\end{equation}\]</div>
<p><a name='eq_3'></a></p>
<div class="arithmatex">\[\begin{equation}
\phi(\omega) = \arctan \left( \frac{2 \zeta r}{1 - r^2} \right)\\
\end{equation}\]</div>
<p><a name='eq_4'></a></p>
<div class="arithmatex">\[\begin{equation}
r = \frac{\omega}{\omega_n}
\end{equation}\]</div>
<details class="info">
<summary>Symbols</summary>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Meaning</th>
<th>SI Unit</th>
<th>Domain</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="arithmatex">\(x(t)\)</span></td>
<td>Tip deflection</td>
<td><span class="arithmatex">\(\mu m\)</span></td>
<td><span class="arithmatex">\(\mathbb{R}\)</span></td>
</tr>
<tr>
<td><span class="arithmatex">\(X(\omega)\)</span></td>
<td>Vibration amplitude</td>
<td><span class="arithmatex">\(\mu m\)</span></td>
<td><span class="arithmatex">\(\mathbb{R}+\)</span></td>
</tr>
<tr>
<td><span class="arithmatex">\(\delta_{\text{st}}\)</span></td>
<td>Static deflection</td>
<td><span class="arithmatex">\(\mu m\)</span></td>
<td><span class="arithmatex">\(\mathbb{R}+\)</span></td>
</tr>
<tr>
<td><span class="arithmatex">\(\zeta\)</span></td>
<td>Damping ratio</td>
<td>-</td>
<td><span class="arithmatex">\([0,1)\)</span> for underdamped systems</td>
</tr>
<tr>
<td><span class="arithmatex">\(\omega_n\)</span></td>
<td>Natural frequency</td>
<td><span class="arithmatex">\(rad/s\)</span> or Hz</td>
<td><span class="arithmatex">\(\mathbb{R}+\)</span></td>
</tr>
<tr>
<td><span class="arithmatex">\(\theta_s\)</span></td>
<td>Sensor position</td>
<td><span class="arithmatex">\(rad\)</span></td>
<td><span class="arithmatex">\([0, 2\pi]\)</span></td>
</tr>
<tr>
<td><span class="arithmatex">\(\phi(\omega)\)</span></td>
<td>Phase angle</td>
<td><span class="arithmatex">\(rad\)</span></td>
<td><span class="arithmatex">\(\mathbb{R}\)</span></td>
</tr>
<tr>
<td><span class="arithmatex">\(\omega\)</span></td>
<td>Excitation frequency</td>
<td><span class="arithmatex">\(rad/s\)</span> or Hz</td>
<td><span class="arithmatex">\(\mathbb{R}+\)</span></td>
</tr>
<tr>
<td><span class="arithmatex">\(EO\)</span></td>
<td>Engine Order</td>
<td>-</td>
<td><span class="arithmatex">\(\mathbb{Z}+\)</span></td>
</tr>
</tbody>
</table>
</details>
<p>Our task is to find values for <span class="arithmatex">\(\delta_{\text{st}}\)</span>, <span class="arithmatex">\(\zeta\)</span>, and <span class="arithmatex">\(\omega_n\)</span> that best fit the data. This approach was set forth as early as 1978. It is, to my best knowledge, the first BTT vibration inference method ever proposed (Zablotskiy and Korostelev, 1978)<sup id="fnref:zablotskiy1978measurement"><a class="footnote-ref" href="#fn:zablotskiy1978measurement">1</a></sup>. </p>
<p>In this chapter, we first produce a simple solution to the above equations. Layers of complexity are added incrementally. I use the incremental approach to emphasize the nonlinear nature of this problem. If you invest time in understanding these concepts, you can apply the lessons wherever you need to determine parameters inside sinusoidal terms in the future. </p>
<p>This chapter culminates in the fulfillment of the promise I made at the start of the tutorial. You'll be able to infer blade frequency, amplitude, and phase from raw time stamps.</p>
<div class="admonition question">
<p class="admonition-title">Outcomes</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m0 2v14H5V5z"/></svg></span> Understand why we require an optimization function to determine the model parameters of the SDoF fit method.</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m0 2v14H5V5z"/></svg></span> Understand why we need to specify upper and lower bounds for the model parameters.</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m0 2v14H5V5z"/></svg></span> Understand why the SDoF model, in its raw form, is not adequate. We need to add phase and amplitude offsets to the objective function.</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m0 2v14H5V5z"/></svg></span> Understand how we can loop over each probe's data to fit the SDoF model to multiple probes.</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m0 2v14H5V5z"/></svg></span> Understand why the EO is treated differently than the other model parameters. Because the EO can only be a positive integer, we iterate over the EOs to identify the optimal EO.</p>
</div>
<h2 id="follow-along">Follow along</h2>
<p>The worksheet for this chapter can be downloaded here <a href="https://github.com/Bladesight/bladesight-worksheets/blob/master/intro_to_btt/ch_08_worksheet.ipynb" target="_blank"><img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white" alt="Open In Github"/></a>.</p>
<p>You can open a Google Colab session of the worksheet here: <a href="https://colab.research.google.com/github/Bladesight/bladesight-worksheets/blob/master/intro_to_btt/ch_08_worksheet.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>.</p>
<p>You need to use one of these Python versions to run the worksheet:
<img src="https://img.shields.io/badge/python-3.9-blue.svg">
<img src="https://img.shields.io/badge/python-3.10-blue.svg">
<img src="https://img.shields.io/badge/python-3.11-blue.svg"></p>
<h2 id="getting-the-dataset">Getting the dataset</h2>
<p>Let's use the dataset from Chapter 5 again. The functions developed in chapters 1 - 6 have been included in the <code>bladesight</code> package. </p>
<p>We use these functions to generate the tip deflections for the dataset:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">[</span><span class="s2">&quot;data/intro_to_btt/intro_to_btt_ch05&quot;</span><span class="p">]</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="n">df_opr_zero_crossings</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;table/opr_zero_crossings&#39;</span><span class="p">]</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="n">df_prox_1</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;table/prox_1_toas&#39;</span><span class="p">]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="n">df_prox_2</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;table/prox_2_toas&#39;</span><span class="p">]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">df_prox_3</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;table/prox_3_toas&#39;</span><span class="p">]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="n">df_prox_4</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;table/prox_4_toas&#39;</span><span class="p">]</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="n">BLADE_COUNT</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="n">RADIUS</span> <span class="o">=</span> <span class="mi">164000</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="n">rotor_blade_AoA_dfs</span> <span class="o">=</span> <span class="n">get_rotor_blade_AoAs</span><span class="p">(</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">df_opr_zero_crossings</span><span class="p">,</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="p">[</span><span class="n">df_prox_1</span><span class="p">,</span> <span class="n">df_prox_2</span><span class="p">,</span> <span class="n">df_prox_3</span><span class="p">,</span> <span class="n">df_prox_4</span><span class="p">],</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">19.34</span><span class="p">,</span> <span class="mf">19.34</span><span class="p">,</span> <span class="mf">19.34</span><span class="p">]))),</span> <span class="c1"># (1)!</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">BLADE_COUNT</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="p">)</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="n">tip_deflection_dfs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">for</span> <span class="n">df_AoAs</span> <span class="ow">in</span> <span class="n">rotor_blade_AoA_dfs</span><span class="p">:</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">df_tip_deflections</span> <span class="o">=</span> <span class="n">get_blade_tip_deflections_from_AoAs</span><span class="p">(</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="n">df_AoAs</span><span class="p">,</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="n">RADIUS</span><span class="p">,</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="mi">11</span><span class="p">,</span><span class="c1">#(2)!</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="mi">2</span><span class="p">,</span><span class="c1">#(3)!</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="mf">0.5</span><span class="c1">#(4)!</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="p">)</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">tip_deflection_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_tip_deflections</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>These are the angles between probes 2 to 4 relative to probe 1.</li>
<li>The order of the zeroing polynomial.</li>
<li>The order of the Butterworth filter.</li>
<li>The cutoff frequency of the Butterworth filter.</li>
</ol>
<p>We plot the peak-to-peak vibration for blade 1 in <a href="#figure_02">Figure 2</a> below.</p>
<script src="c08_blade_1_pk_pk.js" > </script>
<div>
    <div>
        <canvas id="c08_blade_1_pk_pk"'></canvas>
    </div>
    <script>
        async function render_chart_c08_blade_1_pk_pk() {
            const ctx = document.getElementById('c08_blade_1_pk_pk');
            // If this is a mobile device, set the canvas height to 400
            if (window.innerWidth < 500) {
                ctx.height = 400;
            }
            while (typeof Chart == "undefined") {
                await new Promise(r => setTimeout(r, 1000));
            }
            Chart.defaults.font.family = "Literata, -apple-system, BlinkMacSystemFont, Helvetica, Arial, sans-serif";
            window.fig_c08_blade_1_pk_pk = new Chart(ctx, window.c08_blade_1_pk_pk);
            window.fig_c08_blade_1_pk_pk_reset = function resetZoomFig1() {
                    window.fig_c08_blade_1_pk_pk.resetZoom();
                }
            }
        render_chart_c08_blade_1_pk_pk();
    </script>
    <a onclick="window.fig_c08_blade_1_pk_pk_reset()" class='md-button'>Reset Zoom</a>
</div>
<figure>
<figcaption>
        <strong><a name='figure_02'>Figure 2</a></strong>: The peak-to-peak vibration levels for a five blade blisk with four probes. The left and right edges of the peak-to-peak chart curls up but never returns back to a low value, as is usually the case with transient resonances. This is a consequence of the zeroing we performed. Since those regions don't contain resonances, we can live with these end effects.
  </figcaption>
</figure>
<p>The peak-to-peak vibration for blade 1 is presented in <a href="figure_02">Figure 2</a> above. There seems to be symmetric resonance events on the up and downward ramps. </p>
<p>For illustrative purposes, we focus on the resonance event between shaft revolutions 500 and 600.</p>
<div class="admonition note">
<p class="admonition-title">End effects</p>
<p>You may have noticed the ends of the peak-to-peak vibration increase without a subsequent decrease. Resonance events are usually identified by the peak-to-peak vibration increasing as the event starts, and decreasing as the event finishes.</p>
<p>The end effects observed in <a href="#figure_02">Figure 2</a> is not a resonance event. It is an artifact of the order domain polynomial detrending we performed <a href=https://docs.bladesight.com/tutorials/intro_to_btt/ch6/#order-domain-polynomial-detrending target="_blank">in Chapter 6</a>. The order domain zeroing often skews the peak-to-peak vibration values near the edges.</p>
<p>If there were resonances in those regions, we would have taken the time to perform better zeroing. From prior experience, I can confirm there are no resonances in those regions, so we can simply proceed.</p>
</div>
<p>The original method (Zablotskiy and Korostelev, 1978)<sup id="fnref2:zablotskiy1978measurement"><a class="footnote-ref" href="#fn:zablotskiy1978measurement">1</a></sup> used only one probe's data to fit the model. We'll also start with just one probe. </p>
<h2 id="the-nontrivial-nature-of-the-problem">The nontrivial nature of the problem</h2>
<p>It is conventional for engineers to invert the equation that contains the variable we want to solve. Let's start with solving for the EO. We invert <a href="#eq_1">Equation 1</a> below:</p>
<p><a name='eq_5'></a></p>
<div class="arithmatex">\[\begin{align}
x(t) &amp;= X(\omega) \cos \left( \theta_s \cdot EO - \phi(\omega) \right ) \\
\frac{x(t)}{X(\omega)} &amp;= \cos \left( \theta_s \cdot EO - \phi(\omega) \right ) \\
\arccos \left( \frac{x(t)}{X(\omega)} \right) &amp;= \theta_s \cdot EO - \phi(\omega) \\
\theta_s \cdot EO &amp;= \arccos \left( \frac{x(t)}{X(\omega)} \right) + \phi(\omega) \\
EO &amp;= \frac{\arccos \left( \frac{x(t)}{X(\omega)} \right) + \phi(\omega)}{\theta_s}
\end{align}\]</div>
<p>the below domain constraint is required:</p>
<div class="arithmatex">\[\begin{equation}
-1 \leq \frac{x(t)}{X(\omega)} \leq 1
\end{equation}\]</div>
<p>How easy is it to solve for <span class="arithmatex">\(EO\)</span> using this inversion? I have no idea <img alt="ü§∑‚Äç‚ôÇÔ∏è" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f937-200d-2642-fe0f.svg" title=":man_shrugging:" /> . It seems absurdly difficult to me. </p>
<p>Firstly, the model parameters, <span class="arithmatex">\(\delta_{\text{st}}\)</span>, <span class="arithmatex">\(\zeta\)</span>, and <span class="arithmatex">\(\omega_n\)</span>, are all inside the <span class="arithmatex">\(X(\omega)\)</span> and <span class="arithmatex">\(\phi(\omega)\)</span> terms. They are also unknown! We could rearrange the equations to solve for these parameters, but we would have the same problem. Our model parameters cannot be solved for directly.</p>
<p>Secondly, we have a domain constraint on the argument of the arccos function. This means we have to solve for <span class="arithmatex">\(EO\)</span> using a nonlinear constraint. I don't like the sound of that. If you do manage to find a closed form analytic solution for the model parameters, don't send it to me, send it to the Nobel committee.</p>
<p>We therefore resort to computational techniques. We'll use an optimization algorithm to find the solution.</p>
<p>The first step we take toward a solution is to <em>guess</em> the EO of vibration. The decision to arbitrarily <em>guess</em> the EO may make you uneasy. In most undergraduate courses, we are used to well-posed problems. Give me the mass of a body and the force acting on it, and I can tell you the acceleration with 100% certainty. Solving the SDoF fit method is not like that.</p>
<p>Solving the SDoF fit problem is a bit like dating. The only way to find the right person is to first commit to the relationship, and assess how it goes.</p>
<p>How can we make an intelligent guess for the EO? We can use the formula below:</p>
<div class="arithmatex">\[\begin{equation}
EO = \frac{\text{Natural frequency}}{\text{Shaft speed}}
\end{equation}\]</div>
<p>We've seen this equation before. It is the definition of the Engine Order. The EO is the integer multiple of the shaft speed that determines the excitation frequency.</p>
<p>For the blades used in this tutorial, I happen to know (because I designed these blades) that the blades' first natural frequency is approximately 125 Hz. To get a shaft speed, we take the median shaft speed inside the resonance region that we've identified between revolutions 500 and 600, which is 950 RPM:</p>
<div class="arithmatex">\[
\text{EO} = \frac{125}{950 / 60} \approx 7.9
\]</div>
<p>We'll therefore start with a guess of 8 for our EO. Is it a good guess? That will be revealed at the end of this chapter.</p>
<div class="admonition note">
<p class="admonition-title">What if the natural frequencies are not known?</p>
<p>Don't worry. We just need to pick an EO to start with for our optimization algorithm. Later in the chapter, we loop over a range of EOs and compare the objective function values to identify the optimal EO. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Why are we assuming there is only one frequency that dominates the response?</p>
<p>This entire chapter is based on the assumption that there is one frequency that dominates the response. That is the definition of the SDoF model. It is a simplification that is often good enough. Here's an appropriate quote often attributed to George Box: "All models are wrong, but some are useful" (Box, 1979)<sup id="fnref:box1979robustness"><a class="footnote-ref" href="#fn:box1979robustness">2</a></sup>. </p>
<p>In reality, the blade will respond at many different frequencies simultaneously. However, if the blades are in resonance, the response will likely be dominated by the natural frequency.</p>
</div>
<h2 id="resonance-window-selection">Resonance window selection</h2>
<p>To fit our SDoF model, we need to identify data in a resonance region. In other words , we must create a new <code>DataFrame</code> that contains only the tip deflections <em>within</em> a resonance region. </p>
<p>We can use the shaft revolution number to construct this new <code>DataFrame</code> . The <code>eval</code> method of a Pandas DataFrame can be used to this end:</p>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">df_resonance_window</span> <span class="o">=</span> <span class="n">tip_deflection_dfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;n &gt; 500 and n &lt; 600&quot;</span><span class="p">)</span>
</span></code></pre></div>
In the code snippet above, we first select the tip deflections that belong to the first blade (<code>tip_deflection_dfs[0]</code>), and then we select only the tip deflections occurring between shaft revolutions 500 and 600 (<code>query("n &gt; 500 and n &lt; 600")</code>).</p>
<div class="admonition note">
<p class="admonition-title">Can't window selection be automated?</p>
<p>Yes. Techniques exist to automatically identify resonance regions. Some of them have been patented. They are not included here because they are not required for solving the SDoF fit equations.</p>
</div>
<h2 id="a-simple-objective-function">A simple objective function</h2>
<p>Many optimization algorithms are available in Python. These algorithms require an <em>objective function</em>. The objective function evaluates how <em>good</em> a proposed set of model parameters are by returning an error between the predicted tip deflections and the observed tip deflections. It should return a small error for a good fit and a large error for a bad fit. The optimization algorithm searches for parameters that minimize the objective function.</p>
<p>Let's start with a simple objective function. We'll use the sum of squared error between the measured tip deflections, and the predicted tip deflections defined in <a href="#eq_1">Equation 1</a> to <a href="#eq_4">Equation 4</a>. </p>
<p>The code for this objective function is shown below:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span>
<span class="normal"><a href="#__codelineno-2-32">32</a></span>
<span class="normal"><a href="#__codelineno-2-33">33</a></span>
<span class="normal"><a href="#__codelineno-2-34">34</a></span>
<span class="normal"><a href="#__codelineno-2-35">35</a></span>
<span class="normal"><a href="#__codelineno-2-36">36</a></span>
<span class="normal"><a href="#__codelineno-2-37">37</a></span>
<span class="normal"><a href="#__codelineno-2-38">38</a></span>
<span class="normal"><a href="#__codelineno-2-39">39</a></span>
<span class="normal"><a href="#__codelineno-2-40">40</a></span>
<span class="normal"><a href="#__codelineno-2-41">41</a></span>
<span class="normal"><a href="#__codelineno-2-42">42</a></span>
<span class="normal"><a href="#__codelineno-2-43">43</a></span>
<span class="normal"><a href="#__codelineno-2-44">44</a></span>
<span class="normal"><a href="#__codelineno-2-45">45</a></span>
<span class="normal"><a href="#__codelineno-2-46">46</a></span>
<span class="normal"><a href="#__codelineno-2-47">47</a></span>
<span class="normal"><a href="#__codelineno-2-48">48</a></span>
<span class="normal"><a href="#__codelineno-2-49">49</a></span>
<span class="normal"><a href="#__codelineno-2-50">50</a></span>
<span class="normal"><a href="#__codelineno-2-51">51</a></span>
<span class="normal"><a href="#__codelineno-2-52">52</a></span>
<span class="normal"><a href="#__codelineno-2-53">53</a></span>
<span class="normal"><a href="#__codelineno-2-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_X</span><span class="p">(</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>        <span class="n">omega</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>        <span class="n">omega_n</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>        <span class="n">zeta</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a>        <span class="n">delta_st</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span><span class="c1">#(1)!</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">/</span> <span class="n">omega_n</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>    <span class="k">return</span> <span class="p">(</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a>        <span class="n">delta_st</span> 
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a>        <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a>            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> 
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a>            <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">zeta</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a>        <span class="p">)</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a>    <span class="p">)</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_phi</span><span class="p">(</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17"></a>    <span class="n">omega</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18"></a>    <span class="n">omega_n</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19"></a>    <span class="n">zeta</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span><span class="c1">#(2)!</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21"></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">/</span> <span class="n">omega_n</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">zeta</span> <span class="o">*</span> <span class="n">r</span><span class="p">,</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23"></a>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict_sdof_samples_simple</span><span class="p">(</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25"></a>    <span class="n">omega_n</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26"></a>    <span class="n">zeta</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27"></a>    <span class="n">delta_st</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28"></a>    <span class="n">EO</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29"></a>    <span class="n">theta_sensor</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30"></a>    <span class="n">arr_omega</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span><span class="c1">#(3)!</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">get_X</span><span class="p">(</span><span class="n">arr_omega</span><span class="o">*</span><span class="n">EO</span><span class="p">,</span> <span class="n">omega_n</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">delta_st</span><span class="p">)</span><span class="c1">#(4)!</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33"></a>    <span class="n">phi</span> <span class="o">=</span> <span class="n">get_phi</span><span class="p">(</span><span class="n">arr_omega</span><span class="o">*</span><span class="n">EO</span><span class="p">,</span> <span class="n">omega_n</span><span class="p">,</span> <span class="n">zeta</span><span class="p">)</span>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34"></a>    <span class="n">predicted_tip_deflections</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_sensor</span> <span class="o">*</span> <span class="n">EO</span> <span class="o">-</span> <span class="n">phi</span><span class="p">)</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35"></a>    <span class="k">return</span> <span class="n">predicted_tip_deflections</span>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36"></a>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37"></a><span class="k">def</span><span class="w"> </span><span class="nf">SDoF_simple_loss</span><span class="p">(</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38"></a>        <span class="n">model_params</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39"></a>        <span class="n">arr_tip_deflections</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40"></a>        <span class="n">arr_omega</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41"></a>        <span class="n">EO</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42"></a>        <span class="n">theta_sensor</span> <span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span><span class="c1">#(5)!</span>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44"></a>    <span class="n">omega_n</span><span class="p">,</span> <span class="n">ln_zeta</span><span class="p">,</span> <span class="n">delta_st</span> <span class="o">=</span> <span class="n">model_params</span>
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45"></a>    <span class="n">zeta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ln_zeta</span><span class="p">)</span><span class="c1">#(6)!</span>
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46"></a>    <span class="n">predicted_tip_deflections</span> <span class="o">=</span> <span class="n">predict_sdof_samples_simple</span><span class="p">(</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47"></a>        <span class="n">omega_n</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">delta_st</span><span class="p">,</span> <span class="n">EO</span><span class="p">,</span> <span class="n">theta_sensor</span><span class="p">,</span> <span class="n">arr_omega</span>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48"></a>    <span class="p">)</span>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50"></a>        <span class="p">(</span>
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51"></a>            <span class="n">arr_tip_deflections</span>
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52"></a>            <span class="o">-</span> <span class="n">predicted_tip_deflections</span>
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53"></a>        <span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>
<p>This function returns the vibration amplitude of 
    the blade vibration.</p>
<p><code>x(œâ) =     Œ¥_st / sqrt( (1 - r**2)**2 + (2*Œ∂*r)**2)</code></p>
<p>where:</p>
<p>r = œâ/œâ_0</p>
<p>Args:</p>
<div class="language-text highlight"><pre><span></span><code>omega (np.ndarray): The excitation frequencies in rad/s.

omega_n (float): The natural frequency of the blade in rad/s.

zeta (float): The damping ratio of the blade vibration.

delta_st (float, optional): The static deflection of the blade. 
    This value is usually given in units of ¬µm.
</code></pre></div>
<p>Returns:</p>
<div class="language-text highlight"><pre><span></span><code>np.ndarray: The amplitude of the blade vibration in the
    same units as delta_st.
</code></pre></div>
</li>
<li>
<p>Get the phase between the tip deflection and 
        the forcing function. </p>
<p>œÜ(œâ) = arctan(2<em>Œ∂</em>r /  (1 - r**2))</p>
<p>where:
r = œâ/œâ_n</p>
<p>Args:
    omega (np.ndarray): The excitation frequencies in rad/s.</p>
<div class="language-text highlight"><pre><span></span><code>omega_0 (float): The natural frequency of the blade in rad/s.

delta (float): The damping ratio of the blade vibration.
</code></pre></div>
<p>Returns:</p>
<div class="language-text highlight"><pre><span></span><code>np.ndarray: The phase of the blade vibration in rad.
</code></pre></div>
</li>
<li>
<p>This function determined the predicted SDoF fit
    samples at a proximity probe given the SDoF parameters.</p>
<p>Args:</p>
<div class="language-text highlight"><pre><span></span><code>omega_n (float): The natural frequency of the SDoF system.

zeta (float): The damping ratio of the SDoF system.

delta_st (float): The static deflection of the SDoF system.

EO (int): The EO of vibration you want to fit.

theta_sensor (float): The sensor&#39;s angular position on the rotor.

arr_omega (np.ndarray): The angular velocity of the rotor corresponding
    to each revolution for which we want to predict the SDoF samples.
</code></pre></div>
<p>Returns:</p>
<div class="language-text highlight"><pre><span></span><code>np.ndarray: The predicted SDoF samples.
</code></pre></div>
</li>
<li>
<p>Note how we multiply the shaft speed with EO to get the excitation frequency.</p>
</li>
<li>
<p>This function returns the error between the SDoF model given the 
    parameters and the measured tip deflection data.</p>
<p>Args:</p>
<div class="language-text highlight"><pre><span></span><code>model_params (np.ndarray): The SDoF fit method&#39;s model parameters. It
    includes a list of the following parameters:
    omega_n (float): The natural frequency of the SDoF system.
    ln_zeta (float): The damping ratio of the SDoF system.
    delta_st (float): The static deflection of the SDoF system.

arr_tip_deflections (np.ndarray): The tip deflection data of the probe.

arr_omega (np.ndarray): The angular velocity of the rotor corresponding
    to the tip deflection data.

EO (int): The EO of vibration you want to fit.

theta_sensor (float): The sensor&#39;s angular position on the rotor.
</code></pre></div>
<p>Returns:</p>
<div class="language-text highlight"><pre><span></span><code>np.ndarray: The sum of squared error between the tip deflection data
    and the predicted tip deflections.
</code></pre></div>
</li>
<li>
<p>We use the logarithm of the damping ratio to make the optimization
    surface more linear. This helps the optimization algorithm converge faster.</p>
</li>
</ol>
<p>We've broken up our loss function to make it easier to understand. It is dependant on three other functions:</p>
<ol>
<li><code>get_X</code></li>
<li><code>get_phi</code></li>
<li><code>predict_sdof_samples_simple</code></li>
</ol>
<p>The <code>get_X</code> and <code>get_phi</code> functions are used to calculate the vibration amplitude and phase. The <code>predict_sdof_samples_simple</code> function uses these values to predict the tip deflections for a given set of SDoF parameters. The suffix <code>_simple</code> has been added to the function names. It will later become clear why I did this.</p>
<h2 id="optimization-bounds">Optimization bounds</h2>
<p>Which optimization function should we use?</p>
<p>One of the challenges of solving optimization problems where the optimization parameters occur inside sinusoidal terms is they often struggle to converge. This is because the solution space may have many local minima and maxima, and the gradient may not point in the direction of the global optimum. </p>
<p>Our problem contains both cosine and arctan functions, which means the solution space is likely complex and nonlinear. We therefore choose to use a global optimization method because it does not rely on gradients, but rather explores the solution space with a population of candidate solutions. </p>
<p>I experimented with several methods, and found the <code>scipy.optimize.differential_evolution</code> method works well for this problem. I did not have a more profound reason than this. </p>
<p>This method requires us to specify bounds for the optimization parameters. We can specify bounds based on our physical constraints and prior knowledge.</p>
<h3 id="bounds-for-the-natural-frequency">Bounds for the natural frequency</h3>
<p>To set the bounds for the natural frequency, we can use a simple formula based on the engine order and the shaft speed. We have already identified the resonance window. We therefore have all shaft speed values occurring inside the resonance window.</p>
<p>We can therefore calculate the minimum and maximum possible natural frequency as follows:</p>
<div class="arithmatex">\[\begin{equation}
\omega_{n, \textrm{min}} = EO \cdot \Omega_{\textrm{min}}
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\omega_{n, \textrm{max}} = EO \cdot \Omega_{\textrm{max}}
\end{equation}\]</div>
<p>The snippet below shows how to implement this in code:
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">omega_n_min</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;Omega&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">EO</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="n">omega_n_max</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;Omega&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">EO</span>
</span></code></pre></div></td></tr></table></div></p>
<h3 id="bounds-for-damping">Bounds for damping</h3>
<p>Our system is underdamped, which means the damping ratio, <span class="arithmatex">\(\zeta\)</span>, is positive and less than 1 (Rao, 2003)<sup id="fnref:rao2003vibrations"><a class="footnote-ref" href="#fn:rao2003vibrations">3</a></sup>. From experience, a range between 0.0001 and 0.3 should cover all cases encountered in practice.</p>
<p>In the previous chapter, you had an opportunity to change the <span class="arithmatex">\(\zeta\)</span> parameter with a slider and observe the effect this has on the vibration response. You may recall that, when <span class="arithmatex">\(\zeta\)</span> is small, a tiny change in <span class="arithmatex">\(\zeta\)</span> causes a huge change in the vibration amplitude. The optimization algorithm is not privy to this information. The more linear the optimization surface, the easier it is for the optimization algorithm to find the global minimum.</p>
<p>We therefore transform the damping ratio by calculating its natural logarithm. This way, the optimization algorithm can work with a more straightforward relationship between the parameter it is optimizing, <span class="arithmatex">\(\ln(\zeta)\)</span>, and the objective function. </p>
<p>We convert the logarithm of <span class="arithmatex">\(\zeta\)</span> back to the original value inside the objective function, as indicated in Line 45 of the code snippet above.</p>
<p>The bounds for the damping ratio is therefore:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">ln_zeta_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span><span class="c1">#(1)!</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="n">ln_zeta_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>I expected the natural logarithm function to be <code>np.ln</code>. For some reason, it is actually <code>np.log</code>.</li>
</ol>
<h3 id="bounds-for-the-static-deflection">Bounds for the static deflection</h3>
<p>The static deflection bounds are the most application specific. It depends on how large your resonance amplitudes generally are. The higher the vibration amplitude, the wider these bounds should be.</p>
<p>A good initial guess for the current rotor is a value between 0 and 10 <span class="arithmatex">\(\mu m\)</span> for <span class="arithmatex">\(\delta_{\textrm{st}}\)</span>. You can adjust this value later based on your results.</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">delta_st_min</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="n">delta_st_max</span> <span class="o">=</span> <span class="mi">10</span>
</span></code></pre></div></td></tr></table></div>
<h2 id="solving-the-simple-problem">Solving the simple problem</h2>
<p>Now we simply provide these values, along with the optimization function, to the <code>scipy.optimize.differential_evolution</code> function. The code snippet below shows how to do this:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">differential_evolution</span> <span class="c1">#(1)!</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="n">simple_solution</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a>    <span class="n">func</span> <span class="o">=</span> <span class="n">SDoF_simple_loss</span><span class="p">,</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a>    <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="c1">#(2)!</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a>        <span class="p">(</span><span class="n">omega_n_min</span><span class="p">,</span> <span class="n">omega_n_max</span><span class="p">),</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a>        <span class="p">(</span><span class="n">ln_zeta_min</span><span class="p">,</span> <span class="n">ln_zeta_max</span><span class="p">),</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a>        <span class="p">(</span><span class="n">delta_st_min</span><span class="p">,</span> <span class="n">delta_st_max</span><span class="p">)</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a>    <span class="p">],</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a>    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="c1">#(3)!</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;x_p1_filt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="s1">&#39;Omega&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a>        <span class="n">EO</span><span class="p">,</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;AoA_p1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="c1">#(4)!</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a>    <span class="p">),</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a>    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="c1">#(5)!</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>We import the <code>differential_evolution</code> function from the <code>scipy.optimize</code> package. In the worksheet, we do this at the top of the worksheet, not where we solve the problem.</li>
<li>We provide the bounds for the optimization parameters. The optimization algorithm calculates there are 3 parameters, and therefore creates an array of three values being passed into the <code>model_params</code> argument of the <code>SDoF_simple_loss</code> function.</li>
<li>Each one of these arguments correspond to the positional arguments in the <code>SDoF_simple_loss</code> function after the <code>model_params</code> argument. The <code>differential_evolution</code> function will pass these arguments to the <code>SDoF_simple_loss</code> function in the same order.</li>
<li>We use the median value of the AoA as the sensor position. Remember, the <code>AoA_p1</code> column has not been zeroed or normalized yet. </li>
<li>The seed is not strictly necessary, but it ensures the results are reproducible on the same computer. You may even get the exact same answers as I did if you use the same seed.</li>
</ol>
<p>The <code>differential_evolution</code> function returns a <code>OptimizeResult</code> object. We can print this object:
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">simple_solution</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<div class="language-console highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="go"> message: Optimization terminated successfully.</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="go"> success: True</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="go">     fun: 1881551.798646529</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="go">       x: [ 7.887e+02 -6.175e+00  1.469e+00]</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="go">     nit: 15</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="go">    nfev: 760</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="go">     jac: [-9.313e-02  3.423e+00 -4.005e+00]</span>
</span></code></pre></div></p>
<p>Here, the optimization algorithm converged successfully. We can print out the results of the optimization algorithm as follows:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;œâ_n = &quot;</span><span class="p">,</span> <span class="n">simple_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="s2">&quot; Hz&quot;</span><span class="p">)</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Œ∂   = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">simple_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Œ¥_st= &quot;</span><span class="p">,</span> <span class="n">simple_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot; ¬µm&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<div class="language-console highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="go">œâ_n =  125.53304440293931  Hz</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="go">Œ∂   =  0.0020816334883631683</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="go">Œ¥_st=  1.4691101377911184  ¬µm</span>
</span></code></pre></div>
<p>We have solved the SDoF fit method with a global optimization algorithm üëè. </p>
<p>Can we confirm this solution is correct?</p>
<p>It is always a good idea to plot the results. The predicted vs true tip deflections are presented in <a href="#figure_03">Figure 3</a> below.</p>
<script src="c08_resonance_1_simple_fit.js" > </script>
<div>
    <div>
        <canvas id="c08_resonance_1_simple_fit"'></canvas>
    </div>
    <script>
        async function render_chart_c08_resonance_1_simple_fit() {
            const ctx = document.getElementById('c08_resonance_1_simple_fit');
            // If this is a mobile device, set the canvas height to 400
            if (window.innerWidth < 500) {
                ctx.height = 400;
            }
            while (typeof Chart == "undefined") {
                await new Promise(r => setTimeout(r, 1000));
            }
            Chart.defaults.font.family = "Literata, -apple-system, BlinkMacSystemFont, Helvetica, Arial, sans-serif";
            window.fig_c08_resonance_1_simple_fit = new Chart(ctx, window.c08_resonance_1_simple_fit);
            window.fig_c08_resonance_1_simple_fit_reset = function resetZoomFig2() {
                    window.fig_c08_resonance_1_simple_fit.resetZoom();
                }
            }
        render_chart_c08_resonance_1_simple_fit();
    </script>
    <a onclick="window.fig_c08_resonance_1_simple_fit_reset()" class='md-button'>Reset Zoom</a>
</div>
<figure>
<figcaption>
        <strong><a name='figure_03'>Figure 3</a></strong>: The SDoF fit method's predicted tip deflections vs the measured tip deflections.
  </figcaption>
</figure>
<p><a href="#figure_03">Figure 3</a> reveals our model is not a good fit for the measured tip deflections. The two lines share some resemblance, but our fit is far from satisfactory.</p>
<p>One thing our model does capture is the increase in amplitude around <span class="arithmatex">\(n=560\)</span>. This suggests we are on the right track, but we need to refine our model further.</p>
<p>There are two shortcomings we need to fix. First, our model predicts zero tip deflection near the start and end of the resonance. Contrast this to the measured tip deflections, which seems to settle at -80 and -110 Œºm respectively. </p>
<p>The most likely reason for this is because our data zeroing step pushed the "measured" tip deflections past its true zero point. The seemingly negative values may be an artifact of the zeroing process. We need to account for this in our model.</p>
<p>Second, our model <em>only</em> produces positive tip deflections. The measured data, however, shows a sudden negative dip around <span class="arithmatex">\(n=568\)</span>. This means our model misses an important phenomenon. </p>
<p>Why is our model flat when it should predict tip deflections along this sudden dip? </p>
<p>Because we have made a terribly simplistic assumption concerning our <em>phase angle</em>. <a href="#eq_3">Equation 3</a> is the phase angle between the forcing function and the response. This implicitly assumes the forcing function is zero at the start of each revolution. In practice, the phase angle of the forcing function is almost certainly unknown. We therefore need to solve the forcing function offset as well.</p>
<h2 id="amplitude-and-phase-offsets">Amplitude and phase offsets</h2>
<p>We have diagnosed what's wrong with our model: it does not account for amplitude and phase offsets. How do we fix it? Let's start with the phase offset. This is a simple adjustment: we just add a constant term to the argument of the cosine function from <a href="#eq_1">Equation 1</a>. </p>
<p>The new equation is given below:</p>
<p><a name='eq_5'></a></p>
<div class="arithmatex">\[\begin{equation}
x(t) = X(\omega) \cos \left( \theta_s \cdot EO - \phi(\omega) + \phi_0 \right)
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\phi_0\)</span> is our new phase offset. What are the possible values for <span class="arithmatex">\(\phi_0\)</span>? Since the start of the forcing function is unknown, we can assume any value between 0 and <span class="arithmatex">\(2 \pi\)</span>. That's our first improvement.</p>
<p>Next, we need to add an amplitude offset. This is more complicated. A reasonable attempt would be to just add a constant term to each probe's measurements. That would, however, imply our zeroing artifact at the start and the end of the resonance has the same value. No justification for this assumption exists.</p>
<p>Instead, we introduce a linearly-varying amplitude correction. The correction function is defined by two terms, <span class="arithmatex">\(z_{\Omega_{\textrm{median}}}\)</span> and <span class="arithmatex">\(z_{\Omega_{\textrm{max}}}\)</span>. These terms are defined as follows:</p>
<ol>
<li><span class="arithmatex">\(z_{\Omega_{\textrm{median}}}\)</span> is the amplitude correction at the median shaft speed in the resonance window.</li>
<li><span class="arithmatex">\(z_{\Omega_{\textrm{max}}}\)</span> is the amplitude correction at the maximum shaft speed in the resonance window.</li>
</ol>
<p>From these two terms, we can calculate a correction function that varies linearly with shaft speed. </p>
<p>The correction function is defined as follows:</p>
<div class="arithmatex">\[\begin{equation}
z(\Omega) = m_z \cdot \Omega + b_z 
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
m_z = \frac{z_{\Omega_{\textrm{max}}} - z_{\Omega_{\textrm{median}}}}{\Omega_{\textrm{max}} - \Omega_{\textrm{median}}}
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
b_z = z_{\Omega_{\textrm{median}}} - m_z \cdot \Omega_{\textrm{median}}
\end{equation}\]</div>
<p>The terms <span class="arithmatex">\(m_z\)</span> and <span class="arithmatex">\(b_z\)</span> are the slope and intercept of the correction function. They depend on the correction factors, <span class="arithmatex">\(z_{\Omega_{\textrm{median}}}\)</span> and <span class="arithmatex">\(z_{\Omega_{\textrm{max}}}\)</span>, and the median and maximum shaft speeds in the resonance window, <span class="arithmatex">\(\Omega_{\textrm{median}}\)</span> and <span class="arithmatex">\(\Omega_{\textrm{max}}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Correction function vs phase offset</p>
<p>We've added two new concepts: the phase offset term, <span class="arithmatex">\(\phi_0\)</span>, and the correction factors, <span class="arithmatex">\(z_{\Omega_{\textrm{median}}}\)</span> and <span class="arithmatex">\(z_{\Omega_{\textrm{max}}}\)</span>. There is a subtle difference between <em>where these two terms are applied</em>. </p>
<p>The phase offset term, <span class="arithmatex">\(\phi_0\)</span>, is part of our SDoF vibration model. It shifts the entire vibration waveform such that <span class="arithmatex">\(\phi\)</span> represents the phase difference between the force and the tip deflection. The correction function, <span class="arithmatex">\(z(\Omega)\)</span>, is <em>not part of the SDoF vibration model</em>. This correction factor is applied to the <em>measured tip deflections</em>. </p>
</div>
<p>How do we choose the bounds for the correction factors? Hopefully, our optimization algorithm is smart enough to find the optimal solution without us constraining the correction factors too much. We therefore set the positive and negative bounds' size equal to the maximum absolute tip deflection in the resonance window.</p>
<p>The bounds for our new parameters are therefore:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">phi_0_min</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="n">phi_0_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="n">z_max</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;x_p1_filt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="n">z_min</span> <span class="o">=</span> <span class="o">-</span><span class="n">z_max</span>
</span></code></pre></div></td></tr></table></div>
<p>We rewrite our SDoF model as follows:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict_sdof_samples</span><span class="p">(</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>    <span class="n">omega_n</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a>    <span class="n">zeta</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a>    <span class="n">delta_st</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a>    <span class="n">EO</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a>    <span class="n">theta_sensor</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7"></a>    <span class="n">phi_0</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8"></a>    <span class="n">arr_omega</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span><span class="c1">#(1)!</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">get_X</span><span class="p">(</span><span class="n">arr_omega</span><span class="o">*</span><span class="n">EO</span><span class="p">,</span> <span class="n">omega_n</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">delta_st</span><span class="p">)</span>  
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11"></a>    <span class="n">phi</span> <span class="o">=</span> <span class="n">get_phi</span><span class="p">(</span><span class="n">arr_omega</span><span class="o">*</span><span class="n">EO</span><span class="p">,</span> <span class="n">omega_n</span><span class="p">,</span> <span class="n">zeta</span><span class="p">)</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12"></a>    <span class="n">predicted_tip_deflections</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_sensor</span> <span class="o">*</span> <span class="n">EO</span> <span class="o">-</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">phi_0</span><span class="p">)</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13"></a>    <span class="k">return</span> <span class="n">predicted_tip_deflections</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>
<p>This function determined the predicted SDoF fit
    samples at a proximity probe given the SDoF parameters.</p>
<p>Args:</p>
<div class="language-text highlight"><pre><span></span><code>omega_n (float): The natural frequency of the SDoF system.

zeta (float): The damping ratio of the SDoF system.

delta_st (float): The static deflection of the SDoF system.

phi_0 (float): The phase offset of the SDoF system.

EO (int): The EO of vibration you want to fit.

theta_sensor (float): The sensor&#39;s angular position on the rotor.

phi_0 (float): The phase offset of the SDoF system.

arr_omega (np.ndarray): The angular velocity of the rotor corresponding
    to each revolution for which we want to predict the SDoF samples.
</code></pre></div>
<p>Returns:</p>
<div class="language-text highlight"><pre><span></span><code>np.ndarray: The predicted SDoF samples.
</code></pre></div>
</li>
</ol>
<p>Our new loss function is given below:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span>
<span class="normal"><a href="#__codelineno-13-29">29</a></span>
<span class="normal"><a href="#__codelineno-13-30">30</a></span>
<span class="normal"><a href="#__codelineno-13-31">31</a></span>
<span class="normal"><a href="#__codelineno-13-32">32</a></span>
<span class="normal"><a href="#__codelineno-13-33">33</a></span>
<span class="normal"><a href="#__codelineno-13-34">34</a></span>
<span class="normal"><a href="#__codelineno-13-35">35</a></span>
<span class="normal"><a href="#__codelineno-13-36">36</a></span>
<span class="normal"><a href="#__codelineno-13-37">37</a></span>
<span class="normal"><a href="#__codelineno-13-38">38</a></span>
<span class="normal"><a href="#__codelineno-13-39">39</a></span>
<span class="normal"><a href="#__codelineno-13-40">40</a></span>
<span class="normal"><a href="#__codelineno-13-41">41</a></span>
<span class="normal"><a href="#__codelineno-13-42">42</a></span>
<span class="normal"><a href="#__codelineno-13-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_correction_values</span><span class="p">(</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a>    <span class="n">arr_omegas</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a>    <span class="n">z_median</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4"></a>    <span class="n">z_max</span> <span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span><span class="c1">#(1)!</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6"></a>    <span class="n">omega_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">arr_omegas</span><span class="p">)</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7"></a>    <span class="n">omega_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">arr_omegas</span><span class="p">)</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8"></a>    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9"></a>        <span class="n">z_max</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10"></a>        <span class="o">-</span> <span class="n">z_median</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11"></a>    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12"></a>        <span class="n">omega_max</span> 
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13"></a>        <span class="o">-</span> <span class="n">omega_median</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14"></a>    <span class="p">)</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15"></a>    <span class="n">b</span> <span class="o">=</span> <span class="n">z_median</span> <span class="o">-</span> <span class="n">m</span> <span class="o">*</span> <span class="n">omega_median</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16"></a>    <span class="n">correction_values</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">arr_omegas</span>  <span class="o">+</span> <span class="n">b</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17"></a>    <span class="k">return</span> <span class="n">correction_values</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18"></a>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="k">def</span><span class="w"> </span><span class="nf">SDoF_loss</span><span class="p">(</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20"></a>        <span class="n">model_params</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21"></a>        <span class="n">arr_tip_deflections</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22"></a>        <span class="n">arr_omega</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23"></a>        <span class="n">EO</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24"></a>        <span class="n">theta_sensor</span> <span class="p">:</span> <span class="nb">float</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span><span class="c1">#(2)!</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26"></a>    <span class="n">omega_n</span><span class="p">,</span> <span class="n">ln_zeta</span><span class="p">,</span> <span class="n">delta_st</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="n">z_median</span><span class="p">,</span> <span class="n">z_max</span> <span class="o">=</span> <span class="n">model_params</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27"></a>    <span class="n">zeta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ln_zeta</span><span class="p">)</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28"></a>    <span class="n">predicted_tip_deflections</span> <span class="o">=</span> <span class="n">predict_sdof_samples</span><span class="p">(</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29"></a>        <span class="n">omega_n</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">delta_st</span><span class="p">,</span> <span class="n">EO</span><span class="p">,</span> <span class="n">theta_sensor</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="n">arr_omega</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30"></a>    <span class="p">)</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31"></a>    <span class="n">arr_tip_deflection_corrections</span> <span class="o">=</span> <span class="n">get_correction_values</span><span class="p">(</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32"></a>        <span class="n">arr_omega</span><span class="p">,</span> <span class="n">z_median</span><span class="p">,</span> <span class="n">z_max</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33"></a>    <span class="p">)</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34"></a>    <span class="n">arr_tip_deflections_corrected</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35"></a>        <span class="n">arr_tip_deflections</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36"></a>        <span class="o">+</span> <span class="n">arr_tip_deflection_corrections</span>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37"></a>    <span class="p">)</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39"></a>        <span class="p">(</span>
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40"></a>            <span class="n">arr_tip_deflections_corrected</span>
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41"></a>            <span class="o">-</span> <span class="n">predicted_tip_deflections</span>
</span><span id="__span-13-42"><a id="__codelineno-13-42" name="__codelineno-13-42"></a>        <span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-13-43"><a id="__codelineno-13-43" name="__codelineno-13-43"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>
<p>This function calculates the correction values for each sample
    based on the correction factors.</p>
<p>Args:
    arr_omegas (float): The omega values for each sample.</p>
<div class="language-text highlight"><pre><span></span><code>z_median (float): The correction value at the median shaft speed.

z_max (float): The correction value at the max shaft speed.
</code></pre></div>
<p>Returns:
    np.ndarray: The sample offsets for each sample.</p>
</li>
<li>
<p>This function fits the SDoF parameters to a single 
    probe's tip deflection data.</p>
<p>Args:
    model_params (np.ndarray): The SDoF fit method's model parameters. It
        includes a list of the following parameters:
        omega_n (float): The natural frequency of the SDoF system.
        ln_zeta (float): The damping ratio of the SDoF system.
        delta_st (float): The static deflection of the SDoF system.
        phi_0 (float): The phase offset of the SDoF system.
        z_median (float): The amplitude offset at the median shaft speed.
        z_max (float): The maximum amplitude offset.</p>
<div class="language-text highlight"><pre><span></span><code>arr_tip_deflections (np.ndarray): The tip deflection data of the probe.

arr_omega (np.ndarray): The angular velocity of the rotor corresponding
    to the tip deflection data.

EO (int): The EO of vibration you want to fit.

theta_sensor (float): The sensor&#39;s angular position on the rotor.
</code></pre></div>
<p>Returns:
    np.ndarray: The sum of squared error between the tip deflection data</p>
</li>
</ol>
<p>We've created a new function, <code>get_correction_values</code>. This function calculates the correction values for each sample based on the correction factors. The correction factors are the values that need to be determined during optimization.</p>
<h2 id="solving-the-improved-problem">Solving the improved problem</h2>
<p>We solve the improved problem with the code below:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">improved_solution</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>    <span class="n">func</span> <span class="o">=</span> <span class="n">SDoF_loss</span><span class="p">,</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>    <span class="n">bounds</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>        <span class="p">(</span><span class="n">omega_n_min</span><span class="p">,</span> <span class="n">omega_n_max</span><span class="p">),</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a>        <span class="p">(</span><span class="n">ln_zeta_min</span><span class="p">,</span> <span class="n">ln_zeta_max</span><span class="p">),</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a>        <span class="p">(</span><span class="n">delta_st_min</span><span class="p">,</span> <span class="n">delta_st_max</span><span class="p">),</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a>        <span class="p">(</span><span class="n">phi_0_min</span><span class="p">,</span> <span class="n">phi_0_max</span><span class="p">),</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a>        <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">),</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a>        <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">),</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a>    <span class="p">],</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a>    <span class="n">args</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;x_p1_filt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="s1">&#39;Omega&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a>        <span class="n">EO</span><span class="p">,</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;AoA_p1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16"></a>    <span class="p">),</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17"></a>    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Once again, we can print the results:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span>
<span class="normal"><a href="#__codelineno-15-5">5</a></span>
<span class="normal"><a href="#__codelineno-15-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;œâ_n      = &quot;</span><span class="p">,</span> <span class="n">improved_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="s2">&quot; Hz&quot;</span><span class="p">)</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Œ∂        = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">improved_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Œ¥_st     = &quot;</span><span class="p">,</span> <span class="n">improved_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot; ¬µm&quot;</span><span class="p">)</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;œÜ_0      = &quot;</span><span class="p">,</span> <span class="n">improved_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot; rad&quot;</span><span class="p">)</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;z_median = &quot;</span><span class="p">,</span> <span class="n">improved_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot; ¬µm&quot;</span><span class="p">)</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;z_max    = &quot;</span><span class="p">,</span> <span class="n">improved_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="s2">&quot; ¬µm&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<div class="language-console highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="go">œâ_n      =  126.27747716213543  Hz</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="go">Œ∂        =  0.0026626951829294677</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="go">Œ¥_st     =  3.6772997184546794  ¬µm</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="go">œÜ_0      =  4.683877456932529  rad</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="go">z_median =  55.39278985745745  ¬µm</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="go">z_max    =  134.43742560770318  ¬µm</span>
</span></code></pre></div>
<p>The values are in the same region as the previous solution, except for the static deflection and newly added terms, which were zero by implication in the previous solution.</p>
<p>The predicted vs true tip deflections are presented in <a href="#figure_04">Figure 4</a> below.</p>
<script src="c08_resonance_1_improved_fit.js" > </script>
<div>
    <div>
        <canvas id="c08_resonance_1_improved_fit"'></canvas>
    </div>
    <script>
        async function render_chart_c08_resonance_1_improved_fit() {
            const ctx = document.getElementById('c08_resonance_1_improved_fit');
            // If this is a mobile device, set the canvas height to 400
            if (window.innerWidth < 500) {
                ctx.height = 400;
            }
            while (typeof Chart == "undefined") {
                await new Promise(r => setTimeout(r, 1000));
            }
            Chart.defaults.font.family = "Literata, -apple-system, BlinkMacSystemFont, Helvetica, Arial, sans-serif";
            window.fig_c08_resonance_1_improved_fit = new Chart(ctx, window.c08_resonance_1_improved_fit);
            window.fig_c08_resonance_1_improved_fit_reset = function resetZoomFig3() {
                    window.fig_c08_resonance_1_improved_fit.resetZoom();
                }
            }
        render_chart_c08_resonance_1_improved_fit();
    </script>
    <a onclick="window.fig_c08_resonance_1_improved_fit_reset()" class='md-button'>Reset Zoom</a>
</div>
<figure>
<figcaption>
        <strong><a name='figure_04'>Figure 4</a></strong>: The improved SDoF fit method's predicted tip deflections vs the corrected measured tip deflections.
  </figcaption>
</figure>
<p>That's much better üëè. The model now captures the negative dip around <span class="arithmatex">\(n=568\)</span>. The model also captures the tip deflection at the start and end of the resonance. The only critique is that the model seems to have a lower amplitude than the measured tip deflections where the resonance occurs. </p>
<p>We could delve into a solution. Unfortunately, it makes for a beautiful coding exercise later on üòÅ. </p>
<h2 id="multiple-probe-solution">Multiple probe solution</h2>
<p>We have seen how to apply the SDoF fit method to a single probe's tip deflections. Now we want to extend this method to multiple probes. How do we do that?</p>
<p>The idea is similar to the single probe case. In the single probe case, we had one array of observed tip deflections. Now, we have a set of observed tip deflection arrays, where each array in the set corresponds to a different probe. We also have different <span class="arithmatex">\(\theta_s\)</span> values for each probe, depending on the circumferential spacing between the probes. </p>
<p>We have the same number of <em>model parameters</em>, because the model parameters are independent of the number of probes. We must, however, introduce a set of <em>correction values</em> for each probe. Because of this, our optimization search space scales linearly with the number of probes.</p>
<p>Our new loss function is given in the code below.</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span>
<span class="normal"><a href="#__codelineno-17-15">15</a></span>
<span class="normal"><a href="#__codelineno-17-16">16</a></span>
<span class="normal"><a href="#__codelineno-17-17">17</a></span>
<span class="normal"><a href="#__codelineno-17-18">18</a></span>
<span class="normal"><a href="#__codelineno-17-19">19</a></span>
<span class="normal"><a href="#__codelineno-17-20">20</a></span>
<span class="normal"><a href="#__codelineno-17-21">21</a></span>
<span class="normal"><a href="#__codelineno-17-22">22</a></span>
<span class="normal"><a href="#__codelineno-17-23">23</a></span>
<span class="normal"><a href="#__codelineno-17-24">24</a></span>
<span class="normal"><a href="#__codelineno-17-25">25</a></span>
<span class="normal"><a href="#__codelineno-17-26">26</a></span>
<span class="normal"><a href="#__codelineno-17-27">27</a></span>
<span class="normal"><a href="#__codelineno-17-28">28</a></span>
<span class="normal"><a href="#__codelineno-17-29">29</a></span>
<span class="normal"><a href="#__codelineno-17-30">30</a></span>
<span class="normal"><a href="#__codelineno-17-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">SDoF_loss_multiple_probes</span><span class="p">(</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a>        <span class="n">model_params</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a>        <span class="n">tip_deflections_set</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4"></a>        <span class="n">arr_omega</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5"></a>        <span class="n">EO</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6"></a>        <span class="n">theta_sensor_set</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span><span class="c1">#(1)!</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8"></a>    <span class="n">omega_n</span><span class="p">,</span> <span class="n">ln_zeta</span><span class="p">,</span> <span class="n">delta_st</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="o">*</span><span class="n">correction_factors</span> <span class="o">=</span> <span class="n">model_params</span><span class="c1">#(2)!</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9"></a>    <span class="n">zeta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ln_zeta</span><span class="p">)</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10"></a>    <span class="n">error</span> <span class="o">=</span> <span class="mi">0</span><span class="c1">#(3)!</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11"></a>    <span class="k">for</span> <span class="n">i_probe</span><span class="p">,</span> <span class="n">arr_tip_deflections</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tip_deflections_set</span><span class="p">):</span><span class="c1">#(4)!</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12"></a>        <span class="n">theta_sensor</span> <span class="o">=</span> <span class="n">theta_sensor_set</span><span class="p">[</span><span class="n">i_probe</span><span class="p">]</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13"></a>        <span class="n">predicted_tip_deflections</span> <span class="o">=</span> <span class="n">predict_sdof_samples</span><span class="p">(</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14"></a>            <span class="n">omega_n</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">delta_st</span><span class="p">,</span> <span class="n">EO</span><span class="p">,</span> <span class="n">theta_sensor</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="n">arr_omega</span>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15"></a>        <span class="p">)</span>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16"></a>        <span class="n">z_median</span> <span class="o">=</span> <span class="n">correction_factors</span><span class="p">[</span><span class="n">i_probe</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17"></a>        <span class="n">z_max</span> <span class="o">=</span> <span class="n">correction_factors</span><span class="p">[</span><span class="n">i_probe</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="c1">#(5)!</span>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18"></a>        <span class="n">arr_tip_deflection_corrections</span> <span class="o">=</span> <span class="n">get_correction_values</span><span class="p">(</span>
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19"></a>            <span class="n">arr_omega</span><span class="p">,</span> <span class="n">z_median</span><span class="p">,</span> <span class="n">z_max</span>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20"></a>        <span class="p">)</span>
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21"></a>        <span class="n">arr_tip_deflections_corrected</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-17-22"><a id="__codelineno-17-22" name="__codelineno-17-22"></a>            <span class="n">arr_tip_deflections</span>
</span><span id="__span-17-23"><a id="__codelineno-17-23" name="__codelineno-17-23"></a>            <span class="o">+</span> <span class="n">arr_tip_deflection_corrections</span>
</span><span id="__span-17-24"><a id="__codelineno-17-24" name="__codelineno-17-24"></a>        <span class="p">)</span>
</span><span id="__span-17-25"><a id="__codelineno-17-25" name="__codelineno-17-25"></a>        <span class="n">error</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
</span><span id="__span-17-26"><a id="__codelineno-17-26" name="__codelineno-17-26"></a>            <span class="p">(</span>
</span><span id="__span-17-27"><a id="__codelineno-17-27" name="__codelineno-17-27"></a>                <span class="n">arr_tip_deflections_corrected</span>
</span><span id="__span-17-28"><a id="__codelineno-17-28" name="__codelineno-17-28"></a>                <span class="o">-</span> <span class="n">predicted_tip_deflections</span>
</span><span id="__span-17-29"><a id="__codelineno-17-29" name="__codelineno-17-29"></a>            <span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-17-30"><a id="__codelineno-17-30" name="__codelineno-17-30"></a>        <span class="p">)</span>
</span><span id="__span-17-31"><a id="__codelineno-17-31" name="__codelineno-17-31"></a>    <span class="k">return</span> <span class="n">error</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>
<p>This function fits the SDoF parameters to 
        multiple probes' data.</p>
<p>Args:
    model_params (np.ndarray): The SDoF fit method's model parameters. It
        includes a list of the following parameters:</p>
<div class="language-text highlight"><pre><span></span><code>    omega_n (float): The natural frequency of the SDoF system.

    ln_zeta (float): The damping ratio of the SDoF system.

    delta_st (float): The static deflection of the SDoF system.

    phi_0 (float): The phase offset of the SDoF system.

    And the z_median and z_max for each probe.

        z_median (float): The amplitude offset at the 
            median shaft speed.

        z_max (float): The maximum amplitude offset.

tip_deflections_set (List[np.ndarray]): The tip deflection data for each probe.

arr_omega (np.ndarray): The angular velocity of the rotor corresponding
    to the tip deflection data.

EO (int): The EO of vibration you want to fit.

theta_sensor_set (List[float]): Each sensor&#39;s angular position 
    relative to the start of the revolution.
</code></pre></div>
<p>Returns:</p>
<div class="language-text highlight"><pre><span></span><code>np.ndarray: The sum of squared error between 
    the tip deflection data of each probe and
    the predicted tip deflections.
</code></pre></div>
</li>
<li>
<p>This code unpacks the optimization algorithm model arguments, <code>model_params</code>, into the SDoF parameters and the correction factors. The last variable, <code>correction_factors</code>, has an asterisk, <code>*</code>, in front of it. This is Python's way of allocating <em>the rest</em> of <code>model_params</code> into <code>correction_factors</code>. With this notation, we can use the same loss function, regardless of how many probes we have.</p>
</li>
<li><code>error</code> are now initialized and will be incremented for each probe.</li>
<li>We loop over every probe. Essentially, we do exactly what we did in the previous loss function for each probe.</li>
<li>
<p>We grab the correction factors pertaining to this probe. The correction factors are located in <code>correction_factors</code> in the following order:</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">correction_factors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>    <span class="n">z_median_probe_1</span><span class="p">,</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>    <span class="n">z_max_probe_1</span><span class="p">,</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    <span class="n">z_median_probe_2</span><span class="p">,</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="n">z_max_probe_2</span><span class="p">,</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="o">.</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    <span class="o">.</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    <span class="o">.</span><span class="p">,</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>    <span class="n">z_median_probe_n</span><span class="p">,</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>    <span class="n">z_max_probe_n</span><span class="p">,</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="p">]</span>
</span></code></pre></div>
</li>
</ol>
<p>The code below shows how to use the new loss function to solve the multiple probe problem:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span>
<span class="normal"><a href="#__codelineno-19-21">21</a></span>
<span class="normal"><a href="#__codelineno-19-22">22</a></span>
<span class="normal"><a href="#__codelineno-19-23">23</a></span>
<span class="normal"><a href="#__codelineno-19-24">24</a></span>
<span class="normal"><a href="#__codelineno-19-25">25</a></span>
<span class="normal"><a href="#__codelineno-19-26">26</a></span>
<span class="normal"><a href="#__codelineno-19-27">27</a></span>
<span class="normal"><a href="#__codelineno-19-28">28</a></span>
<span class="normal"><a href="#__codelineno-19-29">29</a></span>
<span class="normal"><a href="#__codelineno-19-30">30</a></span>
<span class="normal"><a href="#__codelineno-19-31">31</a></span>
<span class="normal"><a href="#__codelineno-19-32">32</a></span>
<span class="normal"><a href="#__codelineno-19-33">33</a></span>
<span class="normal"><a href="#__codelineno-19-34">34</a></span>
<span class="normal"><a href="#__codelineno-19-35">35</a></span>
<span class="normal"><a href="#__codelineno-19-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="n">PROBE_COUNT</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a>    <span class="p">(</span><span class="n">omega_n_min</span><span class="p">,</span> <span class="n">omega_n_max</span><span class="p">),</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a>    <span class="p">(</span><span class="n">ln_zeta_min</span><span class="p">,</span> <span class="n">ln_zeta_max</span><span class="p">),</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a>    <span class="p">(</span><span class="n">delta_st_min</span><span class="p">,</span> <span class="n">delta_st_max</span><span class="p">),</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6"></a>    <span class="p">(</span><span class="n">phi_0_min</span><span class="p">,</span> <span class="n">phi_0_max</span><span class="p">),</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="p">]</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="n">tip_deflections_set</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="n">theta_sensor_set</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="k">for</span> <span class="n">i_probe</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PROBE_COUNT</span><span class="p">):</span><span class="c1">#(1)!</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11"></a>    <span class="n">z_max</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_filt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12"></a>    <span class="n">z_min</span> <span class="o">=</span> <span class="o">-</span><span class="n">z_max</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13"></a>    <span class="n">bounds</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14"></a>        <span class="p">[</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15"></a>            <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">),</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16"></a>            <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">)</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17"></a>        <span class="p">]</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18"></a>    <span class="p">)</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19"></a>    <span class="n">tip_deflections_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_filt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21"></a>    <span class="p">)</span>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22"></a>    <span class="n">theta_sensor_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;AoA_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24"></a>    <span class="p">)</span>
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25"></a>
</span><span id="__span-19-26"><a id="__codelineno-19-26" name="__codelineno-19-26"></a><span class="n">multiple_probes_solution</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span>
</span><span id="__span-19-27"><a id="__codelineno-19-27" name="__codelineno-19-27"></a>    <span class="n">func</span> <span class="o">=</span> <span class="n">SDoF_loss_multiple_probes</span><span class="p">,</span>
</span><span id="__span-19-28"><a id="__codelineno-19-28" name="__codelineno-19-28"></a>    <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
</span><span id="__span-19-29"><a id="__codelineno-19-29" name="__codelineno-19-29"></a>    <span class="n">args</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-19-30"><a id="__codelineno-19-30" name="__codelineno-19-30"></a>        <span class="n">tip_deflections_set</span><span class="p">,</span>
</span><span id="__span-19-31"><a id="__codelineno-19-31" name="__codelineno-19-31"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="s1">&#39;Omega&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-19-32"><a id="__codelineno-19-32" name="__codelineno-19-32"></a>        <span class="n">EO</span><span class="p">,</span>
</span><span id="__span-19-33"><a id="__codelineno-19-33" name="__codelineno-19-33"></a>        <span class="n">theta_sensor_set</span>
</span><span id="__span-19-34"><a id="__codelineno-19-34" name="__codelineno-19-34"></a>    <span class="p">),</span>
</span><span id="__span-19-35"><a id="__codelineno-19-35" name="__codelineno-19-35"></a>    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
</span><span id="__span-19-36"><a id="__codelineno-19-36" name="__codelineno-19-36"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>We loop over each probe and add the bounds, tip deflection array and the probe static position to the optimization problem.</li>
</ol>
<p>There's a bit more effort involved with the setup of our bounds and arguments, but it is conceptually the same as the single probe case.</p>
<p>The results are shown below:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span>
<span class="normal"><a href="#__codelineno-20-4">4</a></span>
<span class="normal"><a href="#__codelineno-20-5">5</a></span>
<span class="normal"><a href="#__codelineno-20-6">6</a></span>
<span class="normal"><a href="#__codelineno-20-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;œâ_n      = &quot;</span><span class="p">,</span> <span class="n">multiple_probes_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="s2">&quot; Hz&quot;</span><span class="p">)</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Œ∂        = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">multiple_probes_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Œ¥_st     = &quot;</span><span class="p">,</span> <span class="n">multiple_probes_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot; ¬µm&quot;</span><span class="p">)</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;œÜ_0      = &quot;</span><span class="p">,</span> <span class="n">multiple_probes_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot; rad&quot;</span><span class="p">)</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="k">for</span> <span class="n">i_probe</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PROBE_COUNT</span><span class="p">):</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;z_median_</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = &quot;</span><span class="p">,</span> <span class="n">multiple_probes_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="o">+</span><span class="n">i_probe</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot; ¬µm&quot;</span><span class="p">)</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;z_max_</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">    = &quot;</span><span class="p">,</span> <span class="n">multiple_probes_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="o">+</span><span class="n">i_probe</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot; ¬µm&quot;</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<div class="language-console highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="go">œâ_n      =  126.25099097038297  Hz</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="go">Œ∂        =  0.0026064673895625176</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="go">Œ¥_st     =  3.687735366342961  ¬µm</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="go">œÜ_0      =  4.833934260209016  rad</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="go">z_median_1 =  64.63941828855289  ¬µm</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="go">z_max_1    =  132.82804180903605  ¬µm</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="go">z_median_2 =  96.0353967585784  ¬µm</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="go">z_max_2    =  37.229680208617246  ¬µm</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="go">z_median_3 =  33.09137450249458  ¬µm</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="go">z_max_3    =  93.7017772103181  ¬µm</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="go">z_median_4 =  163.029855309319  ¬µm</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="go">z_max_4    =  160.06562042963864  ¬µm</span>
</span></code></pre></div>
<p>Again, our model parameters are in the same region as the previous solution. The predicted vs true tip deflections are shown in <a href="#figure_05">Figure 5</a> below. Each probe's fit is drawn on a different tab.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Probe 1 fit</label><label for="__tabbed_1_2">Probe 2 fit</label><label for="__tabbed_1_3">Probe 3 fit</label><label for="__tabbed_1_4">Probe 4 fit</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div>
    <div>
        <canvas id="c08_resonance_multi_probe_1"></canvas>
    </div>
    <a onclick="window.fig_c08_resonance_multi_probe_1_reset()" class='md-button'>Reset Zoom</a>
</div></p>
</div>
<div class="tabbed-block">
<p><div>
    <div>
        <canvas id="c08_resonance_multi_probe_2"></canvas>
    </div>
    <a onclick="window.fig_c08_resonance_multi_probe_2_reset()" class='md-button'>Reset Zoom</a>
</div></p>
</div>
<div class="tabbed-block">
<p><div>
    <div>
        <canvas id="c08_resonance_multi_probe_3"></canvas>
    </div>
    <a onclick="window.fig_c08_resonance_multi_probe_3_reset()" class='md-button'>Reset Zoom</a>
</div></p>
</div>
<div class="tabbed-block">
<p><div>
    <div>
        <canvas id="c08_resonance_multi_probe_4"></canvas>
    </div>
    <a onclick="window.fig_c08_resonance_multi_probe_4_reset()" class='md-button'>Reset Zoom</a>
</div></p>
</div>
</div>
</div>
<script src="c08_resonance_multi_probe_1.js" > </script>
<script src="c08_resonance_multi_probe_2.js" > </script>
<script src="c08_resonance_multi_probe_3.js" > </script>
<script src="c08_resonance_multi_probe_4.js" > </script>
<script>
    async function render_chart_c08_multi_resonances() {
        const ctx_1 = document.getElementById('c08_resonance_multi_probe_1');
        const ctx_2 = document.getElementById('c08_resonance_multi_probe_2');
        const ctx_3 = document.getElementById('c08_resonance_multi_probe_3');
        const ctx_4 = document.getElementById('c08_resonance_multi_probe_4');

        // If this is a mobile device, set the canvas height to 400
        if (window.innerWidth < 500) {
            ctx_1.height = 400;
            ctx_2.height = 400;
            ctx_3.height = 400;
            ctx_4.height = 400;
        }
        while (typeof Chart == "undefined") {
            await new Promise(r => setTimeout(r, 1000));
        }
        Chart.defaults.font.family = "Literata, -apple-system, BlinkMacSystemFont, Helvetica, Arial, sans-serif";
        window.fig_c08_resonance_multi_probe_1 = new Chart(ctx_1, window.c08_resonance_multi_probe_1);
        window.fig_c08_resonance_multi_probe_1_reset = function resetZoomMultiFig1() {
                window.fig_c08_resonance_multi_probe_1.resetZoom();
        }
        window.fig_c08_resonance_multi_probe_2 = new Chart(ctx_2, window.c08_resonance_multi_probe_2);
        window.fig_c08_resonance_multi_probe_2_reset = function resetZoomMultiFig2() {
                window.fig_c08_resonance_multi_probe_2.resetZoom();
        }
        window.fig_c08_resonance_multi_probe_3 = new Chart(ctx_3, window.c08_resonance_multi_probe_3);
        window.fig_c08_resonance_multi_probe_3_reset = function resetZoomMultiFig3() {
                window.fig_c08_resonance_multi_probe_3.resetZoom();
        }
        window.fig_c08_resonance_multi_probe_4 = new Chart(ctx_4, window.c08_resonance_multi_probe_4);
        window.fig_c08_resonance_multi_probe_4_reset = function resetZoomMultiFig4() {
                window.fig_c08_resonance_multi_probe_4.resetZoom();
        }
    }
    render_chart_c08_multi_resonances();
</script>

<figure>
<figcaption>
        <strong><a name='figure_05'>Figure 5</a></strong>: The improved SDoF fit method's predicted tip deflections vs the corrected measured tip deflections for each probe.
  </figcaption>
</figure>
<p>We are happy with the fit for each probe. Our model parameters did not change much from the single probe case. This is exactly what we want to see. A model should be able to fit multiple probes with the same parameters.</p>
<h2 id="estimating-the-eo">Estimating the EO</h2>
<p>Until this point, we have assumed the EO=8. The optimization algorithm will, however, converge to a solution regardless of our choice for EO. Which EO is the correct one?</p>
<p>We can simply repeat the above exercise for multiple EOs and compare the objective function errors. The EO that results in the lowest error value is most likely the correct one.</p>
<p>The code below shows us how to do this:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-22-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-22-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-22-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-22-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-22-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-22-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-22-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-22-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-22-10">10</a></span>
<span class="normal"><a href="#__codelineno-22-11">11</a></span>
<span class="normal"><a href="#__codelineno-22-12">12</a></span>
<span class="normal"><a href="#__codelineno-22-13">13</a></span>
<span class="normal"><a href="#__codelineno-22-14">14</a></span>
<span class="normal"><a href="#__codelineno-22-15">15</a></span>
<span class="normal"><a href="#__codelineno-22-16">16</a></span>
<span class="normal"><a href="#__codelineno-22-17">17</a></span>
<span class="normal"><a href="#__codelineno-22-18">18</a></span>
<span class="normal"><a href="#__codelineno-22-19">19</a></span>
<span class="normal"><a href="#__codelineno-22-20">20</a></span>
<span class="normal"><a href="#__codelineno-22-21">21</a></span>
<span class="normal"><a href="#__codelineno-22-22">22</a></span>
<span class="normal"><a href="#__codelineno-22-23">23</a></span>
<span class="normal"><a href="#__codelineno-22-24">24</a></span>
<span class="normal"><a href="#__codelineno-22-25">25</a></span>
<span class="normal"><a href="#__codelineno-22-26">26</a></span>
<span class="normal"><a href="#__codelineno-22-27">27</a></span>
<span class="normal"><a href="#__codelineno-22-28">28</a></span>
<span class="normal"><a href="#__codelineno-22-29">29</a></span>
<span class="normal"><a href="#__codelineno-22-30">30</a></span>
<span class="normal"><a href="#__codelineno-22-31">31</a></span>
<span class="normal"><a href="#__codelineno-22-32">32</a></span>
<span class="normal"><a href="#__codelineno-22-33">33</a></span>
<span class="normal"><a href="#__codelineno-22-34">34</a></span>
<span class="normal"><a href="#__codelineno-22-35">35</a></span>
<span class="normal"><a href="#__codelineno-22-36">36</a></span>
<span class="normal"><a href="#__codelineno-22-37">37</a></span>
<span class="normal"><a href="#__codelineno-22-38">38</a></span>
<span class="normal"><a href="#__codelineno-22-39">39</a></span>
<span class="normal"><a href="#__codelineno-22-40">40</a></span>
<span class="normal"><a href="#__codelineno-22-41">41</a></span>
<span class="normal"><a href="#__codelineno-22-42">42</a></span>
<span class="normal"><a href="#__codelineno-22-43">43</a></span>
<span class="normal"><a href="#__codelineno-22-44">44</a></span>
<span class="normal"><a href="#__codelineno-22-45">45</a></span>
<span class="normal"><a href="#__codelineno-22-46">46</a></span>
<span class="normal"><a href="#__codelineno-22-47">47</a></span>
<span class="normal"><a href="#__codelineno-22-48">48</a></span>
<span class="normal"><a href="#__codelineno-22-49">49</a></span>
<span class="normal"><a href="#__codelineno-22-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="n">PROBE_COUNT</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="n">EOs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="n">EO_solutions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4"></a>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="k">for</span> <span class="n">EO</span> <span class="ow">in</span> <span class="n">EOs</span><span class="p">:</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NOW SOLVING FOR EO = &quot;</span><span class="p">,</span> <span class="n">EO</span><span class="p">)</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7"></a>    <span class="n">omega_n_min</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;Omega&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">EO</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8"></a>    <span class="n">omega_n_max</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;Omega&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">EO</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9"></a>    <span class="n">ln_zeta_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10"></a>    <span class="n">ln_zeta_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11"></a>    <span class="n">delta_st_min</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12"></a>    <span class="n">delta_st_max</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13"></a>    <span class="n">phi_0_min</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14"></a>    <span class="n">phi_0_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15"></a>    <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16"></a>        <span class="p">(</span><span class="n">omega_n_min</span><span class="p">,</span> <span class="n">omega_n_max</span><span class="p">),</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17"></a>        <span class="p">(</span><span class="n">ln_zeta_min</span><span class="p">,</span> <span class="n">ln_zeta_max</span><span class="p">),</span>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18"></a>        <span class="p">(</span><span class="n">delta_st_min</span><span class="p">,</span> <span class="n">delta_st_max</span><span class="p">),</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19"></a>        <span class="p">(</span><span class="n">phi_0_min</span><span class="p">,</span> <span class="n">phi_0_max</span><span class="p">),</span>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20"></a>    <span class="p">]</span>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21"></a>    <span class="n">tip_deflections_set</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22"></a>    <span class="n">theta_sensor_set</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-22-23"><a id="__codelineno-22-23" name="__codelineno-22-23"></a>    <span class="k">for</span> <span class="n">i_probe</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PROBE_COUNT</span><span class="p">):</span>
</span><span id="__span-22-24"><a id="__codelineno-22-24" name="__codelineno-22-24"></a>        <span class="n">z_max</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_filt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="__span-22-25"><a id="__codelineno-22-25" name="__codelineno-22-25"></a>        <span class="n">z_min</span> <span class="o">=</span> <span class="o">-</span><span class="n">z_max</span>
</span><span id="__span-22-26"><a id="__codelineno-22-26" name="__codelineno-22-26"></a>        <span class="n">bounds</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="__span-22-27"><a id="__codelineno-22-27" name="__codelineno-22-27"></a>            <span class="p">[</span>
</span><span id="__span-22-28"><a id="__codelineno-22-28" name="__codelineno-22-28"></a>                <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">),</span>
</span><span id="__span-22-29"><a id="__codelineno-22-29" name="__codelineno-22-29"></a>                <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">)</span>
</span><span id="__span-22-30"><a id="__codelineno-22-30" name="__codelineno-22-30"></a>            <span class="p">]</span>
</span><span id="__span-22-31"><a id="__codelineno-22-31" name="__codelineno-22-31"></a>        <span class="p">)</span>
</span><span id="__span-22-32"><a id="__codelineno-22-32" name="__codelineno-22-32"></a>        <span class="n">tip_deflections_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-22-33"><a id="__codelineno-22-33" name="__codelineno-22-33"></a>            <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_filt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-22-34"><a id="__codelineno-22-34" name="__codelineno-22-34"></a>        <span class="p">)</span>
</span><span id="__span-22-35"><a id="__codelineno-22-35" name="__codelineno-22-35"></a>        <span class="n">theta_sensor_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-22-36"><a id="__codelineno-22-36" name="__codelineno-22-36"></a>            <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;AoA_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</span><span id="__span-22-37"><a id="__codelineno-22-37" name="__codelineno-22-37"></a>        <span class="p">)</span>
</span><span id="__span-22-38"><a id="__codelineno-22-38" name="__codelineno-22-38"></a>
</span><span id="__span-22-39"><a id="__codelineno-22-39" name="__codelineno-22-39"></a>    <span class="n">multiple_probes_solution</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span>
</span><span id="__span-22-40"><a id="__codelineno-22-40" name="__codelineno-22-40"></a>        <span class="n">func</span> <span class="o">=</span> <span class="n">SDoF_loss_multiple_probes</span><span class="p">,</span>
</span><span id="__span-22-41"><a id="__codelineno-22-41" name="__codelineno-22-41"></a>        <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
</span><span id="__span-22-42"><a id="__codelineno-22-42" name="__codelineno-22-42"></a>        <span class="n">args</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-22-43"><a id="__codelineno-22-43" name="__codelineno-22-43"></a>            <span class="n">tip_deflections_set</span><span class="p">,</span>
</span><span id="__span-22-44"><a id="__codelineno-22-44" name="__codelineno-22-44"></a>            <span class="n">df_resonance_window</span><span class="p">[</span><span class="s1">&#39;Omega&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-22-45"><a id="__codelineno-22-45" name="__codelineno-22-45"></a>            <span class="n">EO</span><span class="p">,</span>
</span><span id="__span-22-46"><a id="__codelineno-22-46" name="__codelineno-22-46"></a>            <span class="n">theta_sensor_set</span>
</span><span id="__span-22-47"><a id="__codelineno-22-47" name="__codelineno-22-47"></a>        <span class="p">),</span>
</span><span id="__span-22-48"><a id="__codelineno-22-48" name="__codelineno-22-48"></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
</span><span id="__span-22-49"><a id="__codelineno-22-49" name="__codelineno-22-49"></a>    <span class="p">)</span>
</span><span id="__span-22-50"><a id="__codelineno-22-50" name="__codelineno-22-50"></a>    <span class="n">EO_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">multiple_probes_solution</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>This loop takes approximately 1 minute and 30 seconds to run on my laptop. The optimal solution error function value for each EO can be accessed in the <code>.fun</code> attribute of each solution. </p>
<script src="c08_resonance_1_EO_selection.js" > </script>
<div>
    <div>
        <canvas id="c08_resonance_1_EO_selection"></canvas>
    </div>
    <script>
        async function render_chart_c08_resonance_1_EO_selection() {
            const ctx = document.getElementById('c08_resonance_1_EO_selection');
            // If this is a mobile device, set the canvas height to 400
            if (window.innerWidth < 500) {
                ctx.height = 400;
            }
            while (typeof Chart == "undefined") {
                await new Promise(r => setTimeout(r, 1000));
            }
            Chart.defaults.font.family = "Literata, -apple-system, BlinkMacSystemFont, Helvetica, Arial, sans-serif";
            window.fig_c08_resonance_1_EO_selection = new Chart(ctx, window.c08_resonance_1_EO_selection);
            window.fig_c08_resonance_1_EO_selection_reset = function resetZoomFig4() {
                    window.fig_c08_resonance_1_EO_selection.resetZoom();
                }
            }
        render_chart_c08_resonance_1_EO_selection();
    </script>
    <a onclick="window.fig_c08_resonance_1_EO_selection_reset()" class='md-button'>Reset Zoom</a>
</div>
<figure>
<figcaption>
        <strong><a name='figure_06'>Figure 6</a></strong>: The objective function value for each EO.
  </figcaption>
</figure>
<p>From <a href="#figure_06">Figure 6</a> above, our initial guess was correct üí™! The optimal solution errors for each EO decreases gradually as we approach EO=8. EO=8 exhibits the smallest value. It is therefore reasonable to assume the true EO of vibration is 8.</p>
<h2 id="conclusion">Conclusion</h2>
<p>We've come a long way in this chapter. We've learned how to fit the SDoF fit parameters to BTT probe data with a global optimization function. We've also learned how to combine the data from multiple probes to get a more robust estimate of the model parameters.</p>
<p>But what's even more remarkable is how well our simple model works. With just four parameters, we can capture the vibration of the blade tip over multiple revolutions with high accuracy.</p>
<p>In the next and final chapter, we'll explore another way to infer the vibration parameters. This method, however, can be solved using linear algebra. It makes the solution faster and therefore more suitable for real-time analysis.</p>
<div class="admonition question">
<p class="admonition-title">Outcomes</p>
<p><span class="twemoji checkbox-success heart"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m10 17-5-5 1.41-1.42L10 14.17l7.59-7.59L19 8m0-5H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"/></svg></span> Understand why we require an optimization function to determine the model parameters of the SDoF fit method.</p>
<p><span class="twemoji checkbox-success heart"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m10 17-5-5 1.41-1.42L10 14.17l7.59-7.59L19 8m0-5H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"/></svg></span> Understand why we need to specify upper and lower bounds for the model parameters.</p>
<p><span class="twemoji checkbox-success heart"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m10 17-5-5 1.41-1.42L10 14.17l7.59-7.59L19 8m0-5H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"/></svg></span> Understand why the SDoF model, in its raw form, is not adequate. We need to add phase and amplitude offsets to the objective function.</p>
<p><span class="twemoji checkbox-success heart"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m10 17-5-5 1.41-1.42L10 14.17l7.59-7.59L19 8m0-5H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"/></svg></span> Understand how we can loop over each probe's data to fit the SDoF model to multiple probes.</p>
<p><span class="twemoji checkbox-success heart"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m10 17-5-5 1.41-1.42L10 14.17l7.59-7.59L19 8m0-5H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2"/></svg></span> Understand why the EO is treated differently than the other model parameters. Because the EO can only be a positive integer, we iterate over the EOs to identify the optimal EO.</p>
</div>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>Thanks to <a href="https://www.linkedin.com/in/justin-s-507338116/" target="_blank">Justin Smith</a> and <a href="https://www.linkedin.com/in/alex-brocco-70218b25b/" target="_blank">Alex Brocco</a> for reviewing this chapter and providing feedback.</p>
<div style='display:flex'>
    <div>
        <a target="_blank" href="https://www.bladesight.com" class="" title="Dawie Diamond" style="border-radius:100%;"> 
            <img src="https://github.com/Bladesight.png?size=300" alt="Dawie Diamond" style="
            border-radius: 100%;
            width: 4.0rem;
        ">
        </a>
    </div>
    <div style='margin-left:2rem'>
        <p>
            <strong>Dawie Diamond</strong>
        </p>
        <p>
            2024-03-19
        </p>
    </div>
</div>

<h2 id="coding-exercises">Coding exercises</h2>
<h3 id="1-getting-the-amplitude-larger">1. Getting the amplitude larger</h3>
<p>We've seen throughout this chapter that our model's amplitude is not quite right. It's too low.</p>
<mark class="critic block">
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.1 9 .9.9L5.9 19H5v-.9zm3.6-6c-.2 0-.5.1-.7.3l-1.8 1.8 3.7 3.8L20.7 7c.4-.4.4-1 0-1.4l-2.3-2.3c-.2-.2-.5-.3-.7-.3m-3.6 3.2L3 17.2V21h3.8l11-11.1zM7 2v3h3v2H7v3H5V7H2V5h3V2z"/></svg></span> Why do you think the amplitude is constantly too low?</p>
<p>Can you write a new objective function that produces a larger <span class="arithmatex">\(\delta_{st}\)</span>?</p>
</mark>
<details class="example">
<summary>Reveal answer (Please try it yourself before revealing the solution)</summary>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span>
<span class="normal"><a href="#__codelineno-23-20">20</a></span>
<span class="normal"><a href="#__codelineno-23-21">21</a></span>
<span class="normal"><a href="#__codelineno-23-22">22</a></span>
<span class="normal"><a href="#__codelineno-23-23">23</a></span>
<span class="normal"><a href="#__codelineno-23-24">24</a></span>
<span class="normal"><a href="#__codelineno-23-25">25</a></span>
<span class="normal"><a href="#__codelineno-23-26">26</a></span>
<span class="normal"><a href="#__codelineno-23-27">27</a></span>
<span class="normal"><a href="#__codelineno-23-28">28</a></span>
<span class="normal"><a href="#__codelineno-23-29">29</a></span>
<span class="normal"><a href="#__codelineno-23-30">30</a></span>
<span class="normal"><a href="#__codelineno-23-31">31</a></span>
<span class="normal"><a href="#__codelineno-23-32">32</a></span>
<span class="normal"><a href="#__codelineno-23-33">33</a></span>
<span class="normal"><a href="#__codelineno-23-34">34</a></span>
<span class="normal"><a href="#__codelineno-23-35">35</a></span>
<span class="normal"><a href="#__codelineno-23-36">36</a></span>
<span class="normal"><a href="#__codelineno-23-37">37</a></span>
<span class="normal"><a href="#__codelineno-23-38">38</a></span>
<span class="normal"><a href="#__codelineno-23-39">39</a></span>
<span class="normal"><a href="#__codelineno-23-40">40</a></span>
<span class="normal"><a href="#__codelineno-23-41">41</a></span>
<span class="normal"><a href="#__codelineno-23-42">42</a></span>
<span class="normal"><a href="#__codelineno-23-43">43</a></span>
<span class="normal"><a href="#__codelineno-23-44">44</a></span>
<span class="normal"><a href="#__codelineno-23-45">45</a></span>
<span class="normal"><a href="#__codelineno-23-46">46</a></span>
<span class="normal"><a href="#__codelineno-23-47">47</a></span>
<span class="normal"><a href="#__codelineno-23-48">48</a></span>
<span class="normal"><a href="#__codelineno-23-49">49</a></span>
<span class="normal"><a href="#__codelineno-23-50">50</a></span>
<span class="normal"><a href="#__codelineno-23-51">51</a></span>
<span class="normal"><a href="#__codelineno-23-52">52</a></span>
<span class="normal"><a href="#__codelineno-23-53">53</a></span>
<span class="normal"><a href="#__codelineno-23-54">54</a></span>
<span class="normal"><a href="#__codelineno-23-55">55</a></span>
<span class="normal"><a href="#__codelineno-23-56">56</a></span>
<span class="normal"><a href="#__codelineno-23-57">57</a></span>
<span class="normal"><a href="#__codelineno-23-58">58</a></span>
<span class="normal"><a href="#__codelineno-23-59">59</a></span>
<span class="normal"><a href="#__codelineno-23-60">60</a></span>
<span class="normal"><a href="#__codelineno-23-61">61</a></span>
<span class="normal"><a href="#__codelineno-23-62">62</a></span>
<span class="normal"><a href="#__codelineno-23-63">63</a></span>
<span class="normal"><a href="#__codelineno-23-64">64</a></span>
<span class="normal"><a href="#__codelineno-23-65">65</a></span>
<span class="normal"><a href="#__codelineno-23-66">66</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">SDoF_loss_multiple_probes</span><span class="p">(</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a>        <span class="n">model_params</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a>        <span class="n">tip_deflections_set</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a>        <span class="n">arr_omega</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5"></a>        <span class="n">EO</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6"></a>        <span class="n">theta_sensor_set</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7"></a>        <span class="n">amplitude_scaling_factor</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#(1)!</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot; This function fits the SDoF parameters to </span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="sd">        multiple probes&#39; data.</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11"></a>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12"></a><span class="sd">    Args:</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13"></a><span class="sd">        model_params (np.ndarray): The SDoF fit method&#39;s model parameters. It</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14"></a><span class="sd">            includes a list of the following parameters:</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15"></a>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16"></a><span class="sd">            omega_n (float): The natural frequency of the SDoF system.</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17"></a><span class="sd">            ln_zeta (float): The damping ratio of the SDoF system.</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18"></a><span class="sd">            delta_st (float): The static deflection of the SDoF system.</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19"></a><span class="sd">            phi_0 (float): The phase offset of the SDoF system.</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20"></a><span class="sd">            And then the z_median and z_max for each probe.</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21"></a><span class="sd">                z_median (float): The amplitude offset at the </span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22"></a><span class="sd">                    median shaft speed.</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23"></a><span class="sd">                z_max (float): The maximum amplitude offset.</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24"></a>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25"></a><span class="sd">        tip_deflections_set (List[np.ndarray]): The tip deflection data for each probe.</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26"></a><span class="sd">        arr_omega (np.ndarray): The angular velocity of the rotor corresponding</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27"></a><span class="sd">            to the tip deflection data.</span>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28"></a><span class="sd">        EO (int): The EO of vibration you want to fit.</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29"></a><span class="sd">        theta_sensor_set (List[float]): Each sensor&#39;s angular position </span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30"></a><span class="sd">            relative to the start of the revolution.</span>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31"></a><span class="sd">        amplitude_scaling_factor (float, optional): A scaling factor to</span>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32"></a><span class="sd">            weight the measured tip deflections. Defaults to 1. Use this value</span>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33"></a><span class="sd">            to reward solutions that better capture the full amplitude of the</span>
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34"></a><span class="sd">            tip deflections.</span>
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35"></a>
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36"></a><span class="sd">    Returns:</span>
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37"></a><span class="sd">        np.ndarray: The sum of squared error between </span>
</span><span id="__span-23-38"><a id="__codelineno-23-38" name="__codelineno-23-38"></a><span class="sd">            the tip deflection data of each probe and</span>
</span><span id="__span-23-39"><a id="__codelineno-23-39" name="__codelineno-23-39"></a><span class="sd">            the predicted tip deflections.</span>
</span><span id="__span-23-40"><a id="__codelineno-23-40" name="__codelineno-23-40"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-23-41"><a id="__codelineno-23-41" name="__codelineno-23-41"></a>    <span class="n">omega_n</span><span class="p">,</span> <span class="n">ln_zeta</span><span class="p">,</span> <span class="n">delta_st</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="o">*</span><span class="n">correction_factors</span> <span class="o">=</span> <span class="n">model_params</span>
</span><span id="__span-23-42"><a id="__codelineno-23-42" name="__codelineno-23-42"></a>    <span class="n">zeta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ln_zeta</span><span class="p">)</span>
</span><span id="__span-23-43"><a id="__codelineno-23-43" name="__codelineno-23-43"></a>    <span class="n">probe_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tip_deflections_set</span><span class="p">)</span>
</span><span id="__span-23-44"><a id="__codelineno-23-44" name="__codelineno-23-44"></a>    <span class="n">error</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-23-45"><a id="__codelineno-23-45" name="__codelineno-23-45"></a>    <span class="k">for</span> <span class="n">i_probe</span><span class="p">,</span> <span class="n">arr_tip_deflections</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tip_deflections_set</span><span class="p">):</span>    
</span><span id="__span-23-46"><a id="__codelineno-23-46" name="__codelineno-23-46"></a>        <span class="n">theta_sensor</span> <span class="o">=</span> <span class="n">theta_sensor_set</span><span class="p">[</span><span class="n">i_probe</span><span class="p">]</span>
</span><span id="__span-23-47"><a id="__codelineno-23-47" name="__codelineno-23-47"></a>        <span class="n">predicted_tip_deflections</span> <span class="o">=</span> <span class="n">predict_sdof_samples</span><span class="p">(</span>
</span><span id="__span-23-48"><a id="__codelineno-23-48" name="__codelineno-23-48"></a>            <span class="n">omega_n</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">delta_st</span><span class="p">,</span> <span class="n">EO</span><span class="p">,</span> <span class="n">theta_sensor</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="n">arr_omega</span>
</span><span id="__span-23-49"><a id="__codelineno-23-49" name="__codelineno-23-49"></a>        <span class="p">)</span>
</span><span id="__span-23-50"><a id="__codelineno-23-50" name="__codelineno-23-50"></a>        <span class="n">z_median</span> <span class="o">=</span> <span class="n">correction_factors</span><span class="p">[</span><span class="n">i_probe</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
</span><span id="__span-23-51"><a id="__codelineno-23-51" name="__codelineno-23-51"></a>        <span class="n">z_max</span> <span class="o">=</span> <span class="n">correction_factors</span><span class="p">[</span><span class="n">i_probe</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-23-52"><a id="__codelineno-23-52" name="__codelineno-23-52"></a>        <span class="n">arr_tip_deflection_corrections</span> <span class="o">=</span> <span class="n">get_correction_values</span><span class="p">(</span>
</span><span id="__span-23-53"><a id="__codelineno-23-53" name="__codelineno-23-53"></a>            <span class="n">arr_omega</span><span class="p">,</span> <span class="n">z_median</span><span class="p">,</span> <span class="n">z_max</span>
</span><span id="__span-23-54"><a id="__codelineno-23-54" name="__codelineno-23-54"></a>        <span class="p">)</span>
</span><span id="__span-23-55"><a id="__codelineno-23-55" name="__codelineno-23-55"></a>        <span class="n">arr_tip_deflections_corrected</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-23-56"><a id="__codelineno-23-56" name="__codelineno-23-56"></a>            <span class="n">arr_tip_deflections</span>
</span><span id="__span-23-57"><a id="__codelineno-23-57" name="__codelineno-23-57"></a>            <span class="o">+</span> <span class="n">arr_tip_deflection_corrections</span>
</span><span id="__span-23-58"><a id="__codelineno-23-58" name="__codelineno-23-58"></a>        <span class="p">)</span>
</span><span id="__span-23-59"><a id="__codelineno-23-59" name="__codelineno-23-59"></a>        <span class="n">error</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
</span><span id="__span-23-60"><a id="__codelineno-23-60" name="__codelineno-23-60"></a>            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">arr_tip_deflections_corrected</span><span class="p">)</span><span class="o">**</span><span class="n">amplitude_scaling_factor</span> <span class="c1">#(2)!</span>
</span><span id="__span-23-61"><a id="__codelineno-23-61" name="__codelineno-23-61"></a>            <span class="o">*</span><span class="p">(</span>
</span><span id="__span-23-62"><a id="__codelineno-23-62" name="__codelineno-23-62"></a>                <span class="n">arr_tip_deflections_corrected</span>
</span><span id="__span-23-63"><a id="__codelineno-23-63" name="__codelineno-23-63"></a>                <span class="o">-</span> <span class="n">predicted_tip_deflections</span>
</span><span id="__span-23-64"><a id="__codelineno-23-64" name="__codelineno-23-64"></a>            <span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-23-65"><a id="__codelineno-23-65" name="__codelineno-23-65"></a>        <span class="p">)</span>
</span><span id="__span-23-66"><a id="__codelineno-23-66" name="__codelineno-23-66"></a>    <span class="k">return</span> <span class="n">error</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>This is a new parameter.</li>
<li>We use the new parameter to scale the error values according to the absolute size of the measured tip deflections. This rewards solutions that better capture the full amplitude of the tip deflections.</li>
</ol>
<p>Usage example:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span>
<span class="normal"><a href="#__codelineno-24-12">12</a></span>
<span class="normal"><a href="#__codelineno-24-13">13</a></span>
<span class="normal"><a href="#__codelineno-24-14">14</a></span>
<span class="normal"><a href="#__codelineno-24-15">15</a></span>
<span class="normal"><a href="#__codelineno-24-16">16</a></span>
<span class="normal"><a href="#__codelineno-24-17">17</a></span>
<span class="normal"><a href="#__codelineno-24-18">18</a></span>
<span class="normal"><a href="#__codelineno-24-19">19</a></span>
<span class="normal"><a href="#__codelineno-24-20">20</a></span>
<span class="normal"><a href="#__codelineno-24-21">21</a></span>
<span class="normal"><a href="#__codelineno-24-22">22</a></span>
<span class="normal"><a href="#__codelineno-24-23">23</a></span>
<span class="normal"><a href="#__codelineno-24-24">24</a></span>
<span class="normal"><a href="#__codelineno-24-25">25</a></span>
<span class="normal"><a href="#__codelineno-24-26">26</a></span>
<span class="normal"><a href="#__codelineno-24-27">27</a></span>
<span class="normal"><a href="#__codelineno-24-28">28</a></span>
<span class="normal"><a href="#__codelineno-24-29">29</a></span>
<span class="normal"><a href="#__codelineno-24-30">30</a></span>
<span class="normal"><a href="#__codelineno-24-31">31</a></span>
<span class="normal"><a href="#__codelineno-24-32">32</a></span>
<span class="normal"><a href="#__codelineno-24-33">33</a></span>
<span class="normal"><a href="#__codelineno-24-34">34</a></span>
<span class="normal"><a href="#__codelineno-24-35">35</a></span>
<span class="normal"><a href="#__codelineno-24-36">36</a></span>
<span class="normal"><a href="#__codelineno-24-37">37</a></span>
<span class="normal"><a href="#__codelineno-24-38">38</a></span>
<span class="normal"><a href="#__codelineno-24-39">39</a></span>
<span class="normal"><a href="#__codelineno-24-40">40</a></span>
<span class="normal"><a href="#__codelineno-24-41">41</a></span>
<span class="normal"><a href="#__codelineno-24-42">42</a></span>
<span class="normal"><a href="#__codelineno-24-43">43</a></span>
<span class="normal"><a href="#__codelineno-24-44">44</a></span>
<span class="normal"><a href="#__codelineno-24-45">45</a></span>
<span class="normal"><a href="#__codelineno-24-46">46</a></span>
<span class="normal"><a href="#__codelineno-24-47">47</a></span>
<span class="normal"><a href="#__codelineno-24-48">48</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="n">PROBE_COUNT</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="n">EO</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="n">omega_n_min</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;Omega&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">EO</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="n">omega_n_max</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;Omega&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">EO</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="n">ln_zeta_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="n">ln_zeta_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="n">delta_st_min</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9"></a><span class="n">delta_st_max</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="n">phi_0_min</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11"></a><span class="n">phi_0_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12"></a>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13"></a><span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14"></a>    <span class="p">(</span><span class="n">omega_n_min</span><span class="p">,</span> <span class="n">omega_n_max</span><span class="p">),</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15"></a>    <span class="p">(</span><span class="n">ln_zeta_min</span><span class="p">,</span> <span class="n">ln_zeta_max</span><span class="p">),</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16"></a>    <span class="p">(</span><span class="n">delta_st_min</span><span class="p">,</span> <span class="n">delta_st_max</span><span class="p">),</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17"></a>    <span class="p">(</span><span class="n">phi_0_min</span><span class="p">,</span> <span class="n">phi_0_max</span><span class="p">),</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18"></a><span class="p">]</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19"></a><span class="n">tip_deflections_set</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20"></a><span class="n">theta_sensor_set</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21"></a><span class="k">for</span> <span class="n">i_probe</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PROBE_COUNT</span><span class="p">):</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22"></a>    <span class="n">z_max</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_filt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23"></a>    <span class="n">z_min</span> <span class="o">=</span> <span class="o">-</span><span class="n">z_max</span>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24"></a>    <span class="n">bounds</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25"></a>        <span class="p">[</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26"></a>            <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">),</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27"></a>            <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">)</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28"></a>        <span class="p">]</span>
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29"></a>    <span class="p">)</span>
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30"></a>    <span class="n">tip_deflections_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_filt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32"></a>    <span class="p">)</span>
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33"></a>    <span class="n">theta_sensor_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;AoA_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35"></a>    <span class="p">)</span>
</span><span id="__span-24-36"><a id="__codelineno-24-36" name="__codelineno-24-36"></a>
</span><span id="__span-24-37"><a id="__codelineno-24-37" name="__codelineno-24-37"></a><span class="n">multiple_probes_solution</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span>
</span><span id="__span-24-38"><a id="__codelineno-24-38" name="__codelineno-24-38"></a>    <span class="n">func</span> <span class="o">=</span> <span class="n">SDoF_loss_multiple_probes</span><span class="p">,</span>
</span><span id="__span-24-39"><a id="__codelineno-24-39" name="__codelineno-24-39"></a>    <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
</span><span id="__span-24-40"><a id="__codelineno-24-40" name="__codelineno-24-40"></a>    <span class="n">args</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-24-41"><a id="__codelineno-24-41" name="__codelineno-24-41"></a>        <span class="n">tip_deflections_set</span><span class="p">,</span>
</span><span id="__span-24-42"><a id="__codelineno-24-42" name="__codelineno-24-42"></a>        <span class="n">df_resonance_window</span><span class="p">[</span><span class="s1">&#39;Omega&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-24-43"><a id="__codelineno-24-43" name="__codelineno-24-43"></a>        <span class="n">EO</span><span class="p">,</span>
</span><span id="__span-24-44"><a id="__codelineno-24-44" name="__codelineno-24-44"></a>        <span class="n">theta_sensor_set</span><span class="p">,</span>
</span><span id="__span-24-45"><a id="__codelineno-24-45" name="__codelineno-24-45"></a>        <span class="mi">2</span> <span class="c1">#(1)!</span>
</span><span id="__span-24-46"><a id="__codelineno-24-46" name="__codelineno-24-46"></a>    <span class="p">),</span>
</span><span id="__span-24-47"><a id="__codelineno-24-47" name="__codelineno-24-47"></a>    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
</span><span id="__span-24-48"><a id="__codelineno-24-48" name="__codelineno-24-48"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>We set the <code>amplitude_scaling_factor</code> to 2. This means the error will be scaled by the square of the absolute value of the measured tip deflections. This rewards solutions that better capture the full amplitude of the tip deflections.</li>
</ol>
</details>
<h3 id="2-writing-a-function-we-can-use">2. Writing a function we can use</h3>
<p>We've covered a lot of ground in this chapter. Let's write a main entrypoint that performs the SDoF fit given a minimum number of arguments.</p>
<mark class="critic block">
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.1 9 .9.9L5.9 19H5v-.9zm3.6-6c-.2 0-.5.1-.7.3l-1.8 1.8 3.7 3.8L20.7 7c.4-.4.4-1 0-1.4l-2.3-2.3c-.2-.2-.5-.3-.7-.3m-3.6 3.2L3 17.2V21h3.8l11-11.1zM7 2v3h3v2H7v3H5V7H2V5h3V2z"/></svg></span> Write a function, called, <code>perform_SDoF_fit</code>, receiving the following three required arguments:</p>
<ol>
<li>The blade tip deflection DataFrame, <code>df_blade</code>.</li>
<li>The revolution number indicating the start of the resonance, <code>n_start</code>.</li>
<li>The revolution number indicating the end of the resonance, <code>n_end</code>.</li>
</ol>
<p>The function should return the following values:</p>
<ol>
<li>The optimal solution, i.e. <span class="arithmatex">\(\omega_n\)</span>, <span class="arithmatex">\(\zeta\)</span>, <span class="arithmatex">\(\delta_{st}\)</span>, and <span class="arithmatex">\(\phi_0\)</span></li>
<li>The EO of vibration.</li>
</ol>
<p>You may optionally accept other parameters to make the function more flexible.</p>
</mark>
<details class="example">
<summary>Reveal answer (Please try it yourself before revealing the solution)</summary>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span>
<span class="normal"><a href="#__codelineno-25-12">12</a></span>
<span class="normal"><a href="#__codelineno-25-13">13</a></span>
<span class="normal"><a href="#__codelineno-25-14">14</a></span>
<span class="normal"><a href="#__codelineno-25-15">15</a></span>
<span class="normal"><a href="#__codelineno-25-16">16</a></span>
<span class="normal"><a href="#__codelineno-25-17">17</a></span>
<span class="normal"><a href="#__codelineno-25-18">18</a></span>
<span class="normal"><a href="#__codelineno-25-19">19</a></span>
<span class="normal"><a href="#__codelineno-25-20">20</a></span>
<span class="normal"><a href="#__codelineno-25-21">21</a></span>
<span class="normal"><a href="#__codelineno-25-22">22</a></span>
<span class="normal"><a href="#__codelineno-25-23">23</a></span>
<span class="normal"><a href="#__codelineno-25-24">24</a></span>
<span class="normal"><a href="#__codelineno-25-25">25</a></span>
<span class="normal"><a href="#__codelineno-25-26">26</a></span>
<span class="normal"><a href="#__codelineno-25-27">27</a></span>
<span class="normal"><a href="#__codelineno-25-28">28</a></span>
<span class="normal"><a href="#__codelineno-25-29">29</a></span>
<span class="normal"><a href="#__codelineno-25-30">30</a></span>
<span class="normal"><a href="#__codelineno-25-31">31</a></span>
<span class="normal"><a href="#__codelineno-25-32">32</a></span>
<span class="normal"><a href="#__codelineno-25-33">33</a></span>
<span class="normal"><a href="#__codelineno-25-34">34</a></span>
<span class="normal"><a href="#__codelineno-25-35">35</a></span>
<span class="normal"><a href="#__codelineno-25-36">36</a></span>
<span class="normal"><a href="#__codelineno-25-37">37</a></span>
<span class="normal"><a href="#__codelineno-25-38">38</a></span>
<span class="normal"><a href="#__codelineno-25-39">39</a></span>
<span class="normal"><a href="#__codelineno-25-40">40</a></span>
<span class="normal"><a href="#__codelineno-25-41">41</a></span>
<span class="normal"><a href="#__codelineno-25-42">42</a></span>
<span class="normal"><a href="#__codelineno-25-43">43</a></span>
<span class="normal"><a href="#__codelineno-25-44">44</a></span>
<span class="normal"><a href="#__codelineno-25-45">45</a></span>
<span class="normal"><a href="#__codelineno-25-46">46</a></span>
<span class="normal"><a href="#__codelineno-25-47">47</a></span>
<span class="normal"><a href="#__codelineno-25-48">48</a></span>
<span class="normal"><a href="#__codelineno-25-49">49</a></span>
<span class="normal"><a href="#__codelineno-25-50">50</a></span>
<span class="normal"><a href="#__codelineno-25-51">51</a></span>
<span class="normal"><a href="#__codelineno-25-52">52</a></span>
<span class="normal"><a href="#__codelineno-25-53">53</a></span>
<span class="normal"><a href="#__codelineno-25-54">54</a></span>
<span class="normal"><a href="#__codelineno-25-55">55</a></span>
<span class="normal"><a href="#__codelineno-25-56">56</a></span>
<span class="normal"><a href="#__codelineno-25-57">57</a></span>
<span class="normal"><a href="#__codelineno-25-58">58</a></span>
<span class="normal"><a href="#__codelineno-25-59">59</a></span>
<span class="normal"><a href="#__codelineno-25-60">60</a></span>
<span class="normal"><a href="#__codelineno-25-61">61</a></span>
<span class="normal"><a href="#__codelineno-25-62">62</a></span>
<span class="normal"><a href="#__codelineno-25-63">63</a></span>
<span class="normal"><a href="#__codelineno-25-64">64</a></span>
<span class="normal"><a href="#__codelineno-25-65">65</a></span>
<span class="normal"><a href="#__codelineno-25-66">66</a></span>
<span class="normal"><a href="#__codelineno-25-67">67</a></span>
<span class="normal"><a href="#__codelineno-25-68">68</a></span>
<span class="normal"><a href="#__codelineno-25-69">69</a></span>
<span class="normal"><a href="#__codelineno-25-70">70</a></span>
<span class="normal"><a href="#__codelineno-25-71">71</a></span>
<span class="normal"><a href="#__codelineno-25-72">72</a></span>
<span class="normal"><a href="#__codelineno-25-73">73</a></span>
<span class="normal"><a href="#__codelineno-25-74">74</a></span>
<span class="normal"><a href="#__codelineno-25-75">75</a></span>
<span class="normal"><a href="#__codelineno-25-76">76</a></span>
<span class="normal"><a href="#__codelineno-25-77">77</a></span>
<span class="normal"><a href="#__codelineno-25-78">78</a></span>
<span class="normal"><a href="#__codelineno-25-79">79</a></span>
<span class="normal"><a href="#__codelineno-25-80">80</a></span>
<span class="normal"><a href="#__codelineno-25-81">81</a></span>
<span class="normal"><a href="#__codelineno-25-82">82</a></span>
<span class="normal"><a href="#__codelineno-25-83">83</a></span>
<span class="normal"><a href="#__codelineno-25-84">84</a></span>
<span class="normal"><a href="#__codelineno-25-85">85</a></span>
<span class="normal"><a href="#__codelineno-25-86">86</a></span>
<span class="normal"><a href="#__codelineno-25-87">87</a></span>
<span class="normal"><a href="#__codelineno-25-88">88</a></span>
<span class="normal"><a href="#__codelineno-25-89">89</a></span>
<span class="normal"><a href="#__codelineno-25-90">90</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">perform_SDoF_fit</span><span class="p">(</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2"></a>    <span class="n">df_blade</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3"></a>    <span class="n">n_start</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4"></a>    <span class="n">n_end</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5"></a>    <span class="n">EOs</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6"></a>    <span class="n">delta_st_max</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7"></a>    <span class="n">verbose</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;This function receives a blade tip deflection DataFrame, and returns </span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="sd">    the SDoF fit model parameters after fitting.</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11"></a>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12"></a><span class="sd">    Args:</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13"></a><span class="sd">        df_blade (pd.DataFrame): The blade tip deflection DataFrame.</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14"></a><span class="sd">        n_start (int): The starting revolution number of the resonance </span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15"></a><span class="sd">            you want to fit.</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16"></a><span class="sd">        n_end (int): The ending revolution number of the resonance </span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17"></a><span class="sd">            you want to fit.</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18"></a><span class="sd">        EOs (List[int], optional): The list of EOs to search for. Defaults </span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19"></a><span class="sd">            to np.arange(1, 20).</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20"></a><span class="sd">        delta_st_max (int, optional): The maximum static deflection within our optimization </span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21"></a><span class="sd">            bounds. Defaults to 10.</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22"></a><span class="sd">        verbose (bool, optional): Whether to print the progress. Defaults to False.</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23"></a>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24"></a><span class="sd">    Returns:</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25"></a><span class="sd">        Dict[str, float]: The fitted model parameters.</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27"></a>    <span class="n">df_resonance_window</span> <span class="o">=</span> <span class="n">df_blade</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n &gt;= </span><span class="si">{</span><span class="n">n_start</span><span class="si">}</span><span class="s2"> and n &lt;= </span><span class="si">{</span><span class="n">n_end</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28"></a>    <span class="n">measured_tip_deflection_signals</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29"></a>        <span class="n">col</span> 
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_resonance_window</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31"></a>        <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_filt&quot;</span><span class="p">)</span>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32"></a>    <span class="p">]</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33"></a>    <span class="n">PROBE_COUNT</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">measured_tip_deflection_signals</span><span class="p">)</span>
</span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34"></a>    <span class="n">eo_solutions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35"></a>    <span class="k">for</span> <span class="n">EO</span> <span class="ow">in</span> <span class="n">EOs</span><span class="p">:</span>
</span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="__span-25-37"><a id="__codelineno-25-37" name="__codelineno-25-37"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NOW SOLVING FOR EO = &quot;</span><span class="p">,</span> <span class="n">EO</span><span class="p">,</span> <span class="s2">&quot; of &quot;</span><span class="p">,</span> <span class="n">EOs</span><span class="p">)</span>
</span><span id="__span-25-38"><a id="__codelineno-25-38" name="__codelineno-25-38"></a>        <span class="n">omega_n_min</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;Omega&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">EO</span>
</span><span id="__span-25-39"><a id="__codelineno-25-39" name="__codelineno-25-39"></a>        <span class="n">omega_n_max</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="s2">&quot;Omega&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">EO</span>
</span><span id="__span-25-40"><a id="__codelineno-25-40" name="__codelineno-25-40"></a>        <span class="n">ln_zeta_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span>
</span><span id="__span-25-41"><a id="__codelineno-25-41" name="__codelineno-25-41"></a>        <span class="n">ln_zeta_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="__span-25-42"><a id="__codelineno-25-42" name="__codelineno-25-42"></a>        <span class="n">delta_st_min</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-25-43"><a id="__codelineno-25-43" name="__codelineno-25-43"></a>        <span class="n">phi_0_min</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-25-44"><a id="__codelineno-25-44" name="__codelineno-25-44"></a>        <span class="n">phi_0_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</span><span id="__span-25-45"><a id="__codelineno-25-45" name="__codelineno-25-45"></a>        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-25-46"><a id="__codelineno-25-46" name="__codelineno-25-46"></a>            <span class="p">(</span><span class="n">omega_n_min</span><span class="p">,</span> <span class="n">omega_n_max</span><span class="p">),</span>
</span><span id="__span-25-47"><a id="__codelineno-25-47" name="__codelineno-25-47"></a>            <span class="p">(</span><span class="n">ln_zeta_min</span><span class="p">,</span> <span class="n">ln_zeta_max</span><span class="p">),</span>
</span><span id="__span-25-48"><a id="__codelineno-25-48" name="__codelineno-25-48"></a>            <span class="p">(</span><span class="n">delta_st_min</span><span class="p">,</span> <span class="n">delta_st_max</span><span class="p">),</span>
</span><span id="__span-25-49"><a id="__codelineno-25-49" name="__codelineno-25-49"></a>            <span class="p">(</span><span class="n">phi_0_min</span><span class="p">,</span> <span class="n">phi_0_max</span><span class="p">),</span>
</span><span id="__span-25-50"><a id="__codelineno-25-50" name="__codelineno-25-50"></a>        <span class="p">]</span>
</span><span id="__span-25-51"><a id="__codelineno-25-51" name="__codelineno-25-51"></a>        <span class="n">tip_deflections_set</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-25-52"><a id="__codelineno-25-52" name="__codelineno-25-52"></a>        <span class="n">theta_sensor_set</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-25-53"><a id="__codelineno-25-53" name="__codelineno-25-53"></a>        <span class="k">for</span> <span class="n">i_probe</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PROBE_COUNT</span><span class="p">):</span>
</span><span id="__span-25-54"><a id="__codelineno-25-54" name="__codelineno-25-54"></a>            <span class="n">z_max</span> <span class="o">=</span> <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_filt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="__span-25-55"><a id="__codelineno-25-55" name="__codelineno-25-55"></a>            <span class="n">z_min</span> <span class="o">=</span> <span class="o">-</span><span class="n">z_max</span>
</span><span id="__span-25-56"><a id="__codelineno-25-56" name="__codelineno-25-56"></a>            <span class="n">bounds</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="__span-25-57"><a id="__codelineno-25-57" name="__codelineno-25-57"></a>                <span class="p">[</span>
</span><span id="__span-25-58"><a id="__codelineno-25-58" name="__codelineno-25-58"></a>                    <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">),</span>
</span><span id="__span-25-59"><a id="__codelineno-25-59" name="__codelineno-25-59"></a>                    <span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">)</span>
</span><span id="__span-25-60"><a id="__codelineno-25-60" name="__codelineno-25-60"></a>                <span class="p">]</span>
</span><span id="__span-25-61"><a id="__codelineno-25-61" name="__codelineno-25-61"></a>            <span class="p">)</span>
</span><span id="__span-25-62"><a id="__codelineno-25-62" name="__codelineno-25-62"></a>            <span class="n">tip_deflections_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-25-63"><a id="__codelineno-25-63" name="__codelineno-25-63"></a>                <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_filt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-25-64"><a id="__codelineno-25-64" name="__codelineno-25-64"></a>            <span class="p">)</span>
</span><span id="__span-25-65"><a id="__codelineno-25-65" name="__codelineno-25-65"></a>            <span class="n">theta_sensor_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="__span-25-66"><a id="__codelineno-25-66" name="__codelineno-25-66"></a>                <span class="n">df_resonance_window</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;AoA_p</span><span class="si">{</span><span class="n">i_probe</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</span><span id="__span-25-67"><a id="__codelineno-25-67" name="__codelineno-25-67"></a>            <span class="p">)</span>
</span><span id="__span-25-68"><a id="__codelineno-25-68" name="__codelineno-25-68"></a>        <span class="n">multiple_probes_solution</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span>
</span><span id="__span-25-69"><a id="__codelineno-25-69" name="__codelineno-25-69"></a>            <span class="n">func</span> <span class="o">=</span> <span class="n">SDoF_loss_multiple_probes</span><span class="p">,</span>
</span><span id="__span-25-70"><a id="__codelineno-25-70" name="__codelineno-25-70"></a>            <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
</span><span id="__span-25-71"><a id="__codelineno-25-71" name="__codelineno-25-71"></a>            <span class="n">args</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-25-72"><a id="__codelineno-25-72" name="__codelineno-25-72"></a>                <span class="n">tip_deflections_set</span><span class="p">,</span>
</span><span id="__span-25-73"><a id="__codelineno-25-73" name="__codelineno-25-73"></a>                <span class="n">df_resonance_window</span><span class="p">[</span><span class="s1">&#39;Omega&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-25-74"><a id="__codelineno-25-74" name="__codelineno-25-74"></a>                <span class="n">EO</span><span class="p">,</span>
</span><span id="__span-25-75"><a id="__codelineno-25-75" name="__codelineno-25-75"></a>                <span class="n">theta_sensor_set</span><span class="p">,</span>
</span><span id="__span-25-76"><a id="__codelineno-25-76" name="__codelineno-25-76"></a>                <span class="mi">2</span>
</span><span id="__span-25-77"><a id="__codelineno-25-77" name="__codelineno-25-77"></a>            <span class="p">),</span>
</span><span id="__span-25-78"><a id="__codelineno-25-78" name="__codelineno-25-78"></a>            <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
</span><span id="__span-25-79"><a id="__codelineno-25-79" name="__codelineno-25-79"></a>        <span class="p">)</span>
</span><span id="__span-25-80"><a id="__codelineno-25-80" name="__codelineno-25-80"></a>        <span class="n">eo_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">multiple_probes_solution</span><span class="p">)</span>
</span><span id="__span-25-81"><a id="__codelineno-25-81" name="__codelineno-25-81"></a>    <span class="n">best_EO_arg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">([</span><span class="n">solution</span><span class="o">.</span><span class="n">fun</span> <span class="k">for</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">eo_solutions</span><span class="p">])</span>
</span><span id="__span-25-82"><a id="__codelineno-25-82" name="__codelineno-25-82"></a>    <span class="n">best_EO</span> <span class="o">=</span> <span class="n">EOs</span><span class="p">[</span><span class="n">best_EO_arg</span><span class="p">]</span>
</span><span id="__span-25-83"><a id="__codelineno-25-83" name="__codelineno-25-83"></a>    <span class="n">best_solution</span> <span class="o">=</span> <span class="n">eo_solutions</span><span class="p">[</span><span class="n">best_EO_arg</span><span class="p">]</span>
</span><span id="__span-25-84"><a id="__codelineno-25-84" name="__codelineno-25-84"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-25-85"><a id="__codelineno-25-85" name="__codelineno-25-85"></a>        <span class="s2">&quot;omega_n&quot;</span> <span class="p">:</span> <span class="n">best_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
</span><span id="__span-25-86"><a id="__codelineno-25-86" name="__codelineno-25-86"></a>        <span class="s2">&quot;zeta&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">best_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="__span-25-87"><a id="__codelineno-25-87" name="__codelineno-25-87"></a>        <span class="s2">&quot;delta_st&quot;</span> <span class="p">:</span> <span class="n">best_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
</span><span id="__span-25-88"><a id="__codelineno-25-88" name="__codelineno-25-88"></a>        <span class="s2">&quot;phi_0&quot;</span> <span class="p">:</span> <span class="n">best_solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
</span><span id="__span-25-89"><a id="__codelineno-25-89" name="__codelineno-25-89"></a>        <span class="s2">&quot;EO&quot;</span> <span class="p">:</span> <span class="n">best_EO</span><span class="p">,</span>
</span><span id="__span-25-90"><a id="__codelineno-25-90" name="__codelineno-25-90"></a>    <span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<p>Usage example:</p>
<div class="language-py highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span>
<span class="normal"><a href="#__codelineno-26-4">4</a></span>
<span class="normal"><a href="#__codelineno-26-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">SDoF_fit_parameters</span> <span class="o">=</span> <span class="n">perform_SDoF_fit</span><span class="p">(</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a>    <span class="n">tip_deflection_dfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a>    <span class="n">n_start</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a>    <span class="n">n_end</span> <span class="o">=</span> <span class="mi">600</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
</details>
<h3 id="3-comparing-resonances-on-the-upward-and-downward-ramps">3. Comparing resonances on the upward and downward ramps</h3>
<p>Throughout this chapter, we've focused on the EO=8 resonance on the ramp-up. We also have an EO=8 resonance on the ramp-down. Since nothing changed in the setup between the two resonances, we would expect the model parameters to be the same for both resonances.</p>
<mark class="critic block">
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.1 9 .9.9L5.9 19H5v-.9zm3.6-6c-.2 0-.5.1-.7.3l-1.8 1.8 3.7 3.8L20.7 7c.4-.4.4-1 0-1.4l-2.3-2.3c-.2-.2-.5-.3-.7-.3m-3.6 3.2L3 17.2V21h3.8l11-11.1zM7 2v3h3v2H7v3H5V7H2V5h3V2z"/></svg></span> Analyze the resonance on the downward ramp and compare the model parameters to the upward ramp.</p>
<p>Do the results make sense?</p>
</mark>
<details class="example">
<summary>Reveal answer (Please try it yourself before revealing the solution)</summary>
<p>This is something you can do yourself. You're welcome to email me your results if you want me to check it.</p>
</details>
<div class="footnote">
<hr />
<ol>
<li id="fn:zablotskiy1978measurement">
<p>Zablotskiy, I.Y., Korostelev, Y.A., 1978. Measurement of resonance vibrations of turbine blades with the ELURA device. Foreign Technology Div Wright-Patterson AFB OH.&#160;<a class="footnote-backref" href="#fnref:zablotskiy1978measurement" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:zablotskiy1978measurement" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:box1979robustness">
<p>Box, G.E., 1979. Robustness in the strategy of scientific model building, in: Robustness in Statistics. Elsevier, pp. 201--236.&#160;<a class="footnote-backref" href="#fnref:box1979robustness" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:rao2003vibrations">
<p>Rao, S., 2003. Machanical vibrations. Pearson Education India.&#160;<a class="footnote-backref" href="#fnref:rao2003vibrations" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  



  


  



                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../ch7/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 7. Synchronous Vibration and Sampling">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                7. Synchronous Vibration and Sampling
              </div>
            </div>
          </a>
        
        
          
          <a href="../ch9/" class="md-footer__link md-footer__link--next" aria-label="Next: 9. Circumferential Fourier Fit (CFF) Method">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                9. Circumferential Fourier Fit (CFF) Method
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Bladesight
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://twitter.com/DawieDiamond" target="_blank" rel="noopener" title="Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/Bladesight" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.linkedin.com/in/dawie-diamond-51089676/" target="_blank" rel="noopener" title="LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.researchgate.net/profile/Dawie-Diamond-2" target="_blank" rel="noopener" title="ResearchGate" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M0 32v448h448V32zm262.2 334.4c-6.6 3-33.2 6-50-14.2-9.2-10.6-25.3-33.3-42.2-63.6-8.9 0-14.7 0-21.4-.6v46.4c0 23.5 6 21.2 25.8 23.9v8.1c-6.9-.3-23.1-.8-35.6-.8-13.1 0-26.1.6-33.6.8v-8.1c15.5-2.9 22-1.3 22-23.9V225c0-22.6-6.4-21-22-23.9V193c25.8 1 53.1-.6 70.9-.6 31.7 0 55.9 14.4 55.9 45.6 0 21.1-16.7 42.2-39.2 47.5 13.6 24.2 30 45.6 42.2 58.9 7.2 7.8 17.2 14.7 27.2 14.7zm22.9-135c-23.3 0-32.2-15.7-32.2-32.2V167c0-12.2 8.8-30.4 34-30.4s30.4 17.9 30.4 17.9l-10.7 7.2s-5.5-12.5-19.7-12.5c-7.9 0-19.7 7.3-19.7 19.7v26.8c0 13.4 6.6 23.3 17.9 23.3 14.1 0 21.5-10.9 21.5-26.8h-17.9v-10.7h30.4c0 20.5 4.7 49.9-34 49.9m-116.5 44.7c-9.4 0-13.6-.3-20-.8v-69.7c6.4-.6 15-.6 22.5-.6 23.3 0 37.2 12.2 37.2 34.5 0 21.9-15 36.6-39.7 36.6"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tracking", "navigation.instant", "navigation.path", "navigation.footer", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "announce.dismiss"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../javascripts/reviews.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-zoom/2.0.1/chartjs-plugin-zoom.min.js"></script>
      
    
  </body>
</html>